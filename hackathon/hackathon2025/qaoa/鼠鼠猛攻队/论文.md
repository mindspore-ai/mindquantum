# 基于Clifford门的量子组合优化算法设计与实现

姓名：谭又维、于亮  单位：电子科技大学

# 摘要

在含噪声中等规模量子（NISQ）设备背景下，本文针对最大割组合优化问题提出了一种基于Clifford门的两步贪心策略量子算法。研究以Ising模型为优化目标，融合ADAPT- Clifford方法，设计了一种贪心梯度驱动的算法。该算法通过动态选择量子比特对及门操作，最后再进行贪心比特翻转能量最小化，逐步降低哈密顿量期望值，实现目标态编码。实验在私人数据集和公开测试集上验证了方法的有效性，能量期望值表现优于基准模板。此外，研究进一步揭示了初始量子比特划分策略对算法效果和稳定性的影响，并通过小型的消融实验，凸显算法的改进。

# 1 问题背景与描述

近年来，量子计算技术迅速发展，NISQ（Noisy Intermediate- Scale Quantum）设备成为研究前沿。变分量子算法（VQA）与量子近似优化算法（QAOA）被广泛用于化学模拟和组合优化[1][2]。然而，传统VQA/QAOA在大规模问题或深电路下难以进行经典模拟，且容易受到噪声影响[2]。相比之下，Clifford量子线路在经典计算机上可高效模拟，并具备一定的纠缠与干涉能力，为NISQ下的组合优化问题提供了新的研究视角。

本赛题旨在使用仅含Clifford门的量子线路解决通用的Ising优化问题，形式化为如下哈密顿量：

$$
H_{c} = \sum_{i}h_{i}\sigma_{z}^{i} + \sum_{i< j\in E}J_{ij}\sigma_{z}^{i}\sigma_{z}^{j}
$$

其中  $\sigma_z^i$  表示第  $i$  个量子比特的Pauli- Z 算符，  $h_i$  是单比特系数，  $J_{ij}$  为双比特耦合系数。

最大割问题是Ising问题的特例，Max- Cut问题是图论中的一个NP- complete问题，它需要将一个图中的顶点分成两部分，并使得这两部分的割边最多。如图1中（a）所示，该图由五个顶点构成，相互连接的边为  $(0,1)$ ，  $(0,2)$ ，  $(1,2)$ ，  $(2,3)$ ，  $(3,4)$ ，  $(0,4)$  。为了使割边最多，我们尝试通过图1中（b）所示的分割，将1、2、4分为一组，0、3分成另一组，因此可得到的割边有5条。当图中顶点较少时，我们可以在较短时间内通过穷举

法找到最大的割边数，但当图中顶点增多时，我们很难找到有效的经典算法来解决Max- Cut问题，因为这类NP- complete问题很有可能不存在多项式时间算法。但尽管精确解不容易得到，我们却可以想办法在多项式时间内找到问题的一个近似解，这就是近似优化算法。

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-05/27a73631-75f1-46fd-9494-9a373d523e6b/6b95c0828a9507dcd18fabd4d79639923b652d48eebd6b34ed626ac8dfba4f35.jpg)  
图1 Max-Cut问题描述

将Max- Cut问题量子化后，我们只需对图中的每条边写出哈密顿量，然后将所有边求和，即可写出图对应的哈密顿量  $H$ ，利用量子计算机求得  $H$  的基态能量与基态，我们就可以得到该图的Max- Cut切割方案与最大割边数[3]。我们记所有边的集合为C，则哈密顿量可写为：

$$
H = \sum_{(i,j) \in C} (Z_i Z_j - 1) / 2
$$

因此Max- Cut问题的解即可通过最小化这个哈密顿量来得到，即找到该哈密顿量的基态。对此我们可以采用量子绝热演化的方法，使系统先处于某一简单哈密顿量  $H_B$  的基态上，然后使简单的哈密顿量  $H_B$  绝热地、缓慢地演化至某一复杂的哈密顿量  $H_C$ ，根据绝热定理，系统将始终保持在哈密顿量的基态上，最终达到复杂哈密顿量  $H_C$  的基态。

QAOA已经在实际的量子系统中得到了应用。然而，由于现有硬件系统的规模和错误率限制，QAOA的应用仍局限于较浅的电路结构和较小规模的问题。此外，VQA和QAOA在实验中还受到噪声的影响，导致其算法性能受限，而大规模量子线路的复杂性也使得它们难以用经典计算机进行有效模拟，这些因素共同构成了量子算法设计与实现的重大挑战。

值得注意的是，Clifford线路能够在经典计算机上高效被模拟，同时这类线路也可以产生和处理纠缠量子态，因此能够为新型量子算法的设计提供新思路。Clifford量子逻辑门集合主要包含H, S, X, Y, Z, CNOT, CY, CZ, SWAP等量子门，这些门的衍生集合也同

样属于Clifford量子逻辑门[4]。当前，Muñoz- Arias等人提出了一种浅层的Clifford线路来求解最大割问题，并且取得了不错的效果。这表明Clifford线路在求解组合优化问题方面存在一定的潜力。

因此，本赛题的目标为：通过一些算法技巧来构建Clifford量子线路解决任意的Ising问题，得到其近似解，使得分数最大化。

# 2 问题分析

对于量子算法求解Max- Cut问题，我们常常通过变分的QAOA算法进行求解，QAOA虽然简单有效，但也有其局限，如固定结构、参数较多、没有利用问题结构等问题。

因此，ADAPT- QAOA就是为了解决这些问题，它让算法结构自适应增长、自动选择哪些门该加入。

受到ADAPT- QAOA线路参数的启发，Muñoz- Arias等人提出的ADAPT- Clifford方法表明Max- Cut问题可以在Clifford线路下近似求解[5]：通过随机初始化和基于梯度的信息增量式贪心地构建量子线路，从而提升优化效果。这也给我们赛题的算法设计提供了一定的启发。

ADAPT- Clifford算法旨在构建浅层但具有优化能力的Clifford量子线路。该算法以贪心的方式，从构建的Clifford算符库中选择算子，逐步加入到量子线路中使得获得最大化能量下降速率（即最大梯度），从而逼近最优解。其构建出的量子线路为Clifford线路，因此能被经典模拟器（如stabilizer模拟器）高效处理。

在赛题给的样例模板中，算法流程首先随机对部分比特作用X门，然后计算每个量子比特翻转后对整体能量的影响，若该量子比特翻转后降低的能量最多，则在该比特上作用X门，最后重复上一操作直到翻转任何比特都不能使得能量降低。该算法也是一种贪心策略。

受到ADAPT- Clifford算法和贪心翻转能量最小化算法的启发，我们可以将上述样例模板算法中的第一步对部分量子比特随机作用X门，改为ADAPT- Clifford算法，随后同样再进行贪心翻转能量最小化的操作，从而实现Clifford线路构建。总的来说，我们是通过两步贪心策略的方法来构建解决任意的Ising问题的Clifford线路。

值得注意的是，ADAPT- Clifford算法的初始值选择对算法也很有影响。因此，我们对初始值的选取部分也设计了一定技巧。

# 3 方案描述

3 方案描述本章详细介绍本文用于求解Ising优化问题的量子线路构建方法，涵盖研究方法选择、理论推导基础、数据采集与建模、核心算法流程与代码结构说明。整体设计遵循Clifford门集合限制以及运算效率等多重要求。

# 3.1研究方法选择

本研究聚焦于解决一般化的Ising模型，其本质可归为组合优化问题。为实现高效求解，我们采用结合量子变分电路设计与启发式贪心策略的混合量子经典方法（HybridQuantum- Classical Approach）。所构建的量子线路基于MindQuantum提供的Clifford门集，并充分利用了MindQuantum所提供的Simulator模拟器的快速仿真能力。

我们基于ADAPT- Clifford的思想构造量子线路，并进行能量梯度优化策略的再设计，使其更适用于当前限定资源下的问题。相比传统的VQE或QAOA，ADAPT- Clifford方法具有以下优势：

1．全Clifford门集：构造出的量子线路完全由Clifford门组成，能够被经典计算机高效模拟；

2. 浅层量子线路：不需要过深的线路深度仍能保持较好能量表现；

3．梯度驱动门选择：每一步根据能量梯度贪心选择最优门，提升搜索效率。

基于上述原则，本文结合ADAPT- Clifford思想构建了example2()算法，并引入两个关键策略：

1．基于梯度的贪心门选择机制；2.后处理的比特翻转能量最小化操作。

# 3.2理论推导基础

考虑如下标准Ising模型Hamiltonian：

$$
H_{c} = \sum_{i}h_{i}\sigma_{z}^{i} + \sum_{i< j\in E}J_{ij}\sigma_{z}^{i}\sigma_{z}^{j}
$$

目标是找到一组  $z_{i}\in \{- 1,1\}$  的取值，使得  $H$  取得最小值。这可转换为二值变量的图划分问题，进一步对应到量子线路上时，需构造能够逼近最优解配置的量子态。

为此，量子电路通过逐层堆叠构建形成，其每一步的门选择依赖于当前量子比特集合上计算出的能量梯度方向，即每次选择最能降低期望能量的门集结构。

# 3.3数据采集与建模

赛题提供的输入数据为对称矩阵Q_triu，表示Ising模型的上三角权重矩阵，我们通过如下方式构造哈密顿量参数：

1．耦合项：

J=np.triu(Q_triu,k=1)+np.triu(Q_triu,k=1).T

2. 偏置项：

n=np.diag(Q_triu)

3. 权重邻接矩阵（含对角）：

W=Q_triu+Q_triu.T- np.diag(np.diag(Q_triu))

该建模过程由example2(nqubit, Q_triu, select_num=None, repeat=1)函数完成，并直接用于电路结构中能量梯度的计算依据。

# 3.4核心算法流程

本方案采用的是基于Clifford门的贪心式变分量子电路构建方法，其核心思想是：通过逐步选择最有利于降低哈密顿量期望值的量子比特对及其门操作，将目标哈密顿量的基态编码到最终电路所制备的量子态中。

求解主流程封装于example2(函数中，可分为以下四个主要阶段：

1. 阶段一：初态构造

算法首先初始化一个n比特的电路，并对每个比特施加Hadamard门H，使其进入均匀叠加态：

$$
\left|\psi_0\right\rangle = H^{\otimes n}|0\rangle^{\otimes n}
$$

其对应代码为：

circ=Circuit(UN(H, nqubit))

这一步保证所有比特初始处于非偏置状态，有助于后续通过门结构精细地调节量子干涉模式。

2. 阶段二：划分初始化

接着从所有量子比特中选取边权值和最大和最小的两个比特，分别放入两个划分子集中，记作  $\mathrm{A_k}$  和  $\mathrm{A_j}$

$$
f = \arg \max_{i}\sum_{j}W_{ij},q = \arg \min_{i}\sum_{j}W_{ij}
$$

其对应代码为：

这两个划分代表当前已被激活并确定初始“位置”的比特子集。在后续步骤中，其余未激活比特将依梯度加入其中之一。

值得注意的是，我们也可以用随机初始化方法将两个比特划分，不过相较于上述方法更不稳定，且其分数期望值实验上不如最大最小边权和划分方法。

3. 阶段三：计算未激活比特的“加入梯度”

核心函数gradient(inaqubit, W, aqubits_k, aqubits_j) 以如下方式计算单个未激活比特q若加入划分  $\mathrm{A_k}$  与  $\mathrm{A_j}$  所带来的“能量变化对比”：

$$
g_{q}^{(k)} = \sum_{j\in A_{j}}W_{qj} - \sum_{k\in A_{k}}W_{qk}
$$

其对应代码为：

grad_k = - sum_weights_k + sum_weights_j

其中：

sum_weights_k = np.sum(W[ll, inaqubit] for ll in lindex_k)，即遍历所有  $\mathrm{x\in A_k}$ ，代表该比特与  $\mathrm{A_k}$  成员之间的耦合强度；

sum_weights_j = np.sum(W[ll, inaqubit] for ll in lindex_j)，即遍历所有  $\mathrm{x\in A_k}$ ，代表该比特与  $\mathrm{A_j}$  成员之间的耦合强度；

计算梯度的直觉来源于点划分对哈密顿量的影响，即该比特若加入划分  $\mathrm{A_k}$ ，则其与  $\mathrm{A_k}$  的边为内部边，对总能量影响为负，反之与  $\mathrm{A_j}$  的边为跨划分边，对总能量影响为正；

因此，grad_k值越大，代表该比特加入  $\mathrm{A_k}$  的“收益”越大（对应目标哈密顿量的期望值下降越多）。

这个梯度评估方式本质上是以边权加权的子图结构优化问题的启发式近似。

4. 阶段四：贪心选择最优比特与目标子集

调用pos_max_grad(inaqubits, W, aqubits_k, aqubits_j)遍历所有未激活比特集合inaqubits，为每个比特计算其加入  $\mathrm{A_k}$  与  $\mathrm{A_j}$  的grad_k，并返回其中最大者；

$$
\begin{array}{r}g_{q}^{(k)} = \max_{q\in U}\left(\sum_{j\in A_{j}}W_{qj} - \sum_{k\in A_{k}}W_{qk}\right)\\ g_{q}^{(j)} = \max_{q\in U}\left(\sum_{k\in A_{k}}W_{qk} - \sum_{j\in A_{j}}W_{qj}\right) \end{array}
$$

其对应代码为：

all_grads_k  $=$  [gradient(inaqubit,W,aqubits_k,aqubits_j)for inaqubit in inaqubits] all_grads_j  $=$  - 1.0\* np.array(all_grads_k) pos_max_k  $=$  np.argmax(all_grads_k) pos_max_j  $=$  np.argmax(all_grads_j) if all_grads_k[pos_max_k] > all_grads_j[pos_max_j]: return "k", inaqubits[pos_max_k], all_grads_k[pos_max_k] elif all_grads_k[pos_max_k]< all_grads_j[pos_max_j]: return "j", inaqubits[pos_max_j], all_grads_j[pos_max_j] else: char  $=$  np.random.choice([1,2]) if char  $= = 1$  . return "k", inaqubits[pos_max_k], all_grads_k[pos_max_k] elif char  $= = 2$  . return "j", inaqubits[pos_max_j], all_grads_j[pos_max_j]

该函数执行贪心策略：总是选择“当前步骤中最能降低能量”的比特及其目标划分组。这一点体现了算法的“adaptive”特征，适应当前量子态能量结构不断调整电路结构。第三种情况是all_grads_k[pos_max_k]=all_grads_j[pos_max_j]，算法将随机选择  $\mathrm{A_k}$  或  $\mathrm{A_j}$ ，将未激活比特加入进去。

5. 阶段五：门结构插入与电路扩展

当目标比特及目标子集确定后，算法从目标子集中随机选取一位比特q2，与新比特q1共同参与构建一组Clifford门序列，通过add_gate(q1,q2）函数插入到当前电路中。该函数构造的门序列相当于一种有效模拟  $e^{i\frac{\pi}{4} YZ}$  结构的门集：

$$
e^{i\frac{\pi}{4} V_{q1}Z_{q2}} = S_{q1}H_{q2}\mathrm{CNOT}_{q1,q2}R_{x}^{(q_{1})}(-\pi /2)\mathrm{CNOT}_{q1,q2}S_{q1}^{\dagger}H_{q2}
$$

其对应代码如下：

def add_gate(q1,q2): eg  $=$  Circuit() eg  $+ =$  S.on(int(q1)) eg  $+ =$  S.on(int(q1)) eg  $+ =$  S.on(int(q1)) eg  $+ =$  H.on(int(q2)) eg  $+ =$  CNOT.on(int(q2),int(q1)) eg  $+ =$  Z.on(int(q1)) eg  $+ =$  H.on(int(q1)) eg  $+ =$  S.on(int(q1)) eg  $+ =$  H.on(int(q1)) eg  $+ =$  S.on(int(q1))

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-05/27a73631-75f1-46fd-9494-9a373d523e6b/93da1ac5aa13ce6e86a32bfa8faae116871ff3e0aa4d5d8c12d99ce642ec59ac.jpg)

这些门组合确保电路保持在Clifford门集合内，便于使用MindQuantum的Clifford仿真器进行高效模拟。

6. 阶段六：迭代构建完整电路

上述步骤3至步骤5会不断重复，直到所有比特均被激活并分配到子集中，且电路已包含每个比特的连接门结构，构成完整的Clifford电路，此时的态为：

$$
\left|\psi \right\rangle = \left[\prod_{r = 2}^{N - 1}e^{i\frac{\pi}{4} Z_l Y_{b(r)}}\right]e^{i\frac{\pi}{4} Z_j Y_k}Z_k\mathrm{H}^{\otimes n}|0\rangle^{\otimes n}
$$

7. 阶段七：比特翻转能量最小化

在比特划分完成后，算法会尝试逐比特翻转其状态，并计算翻转前后的期望能量  $\Delta E$ ，选择翻转带来期望值下降最大的比特并进行翻转：

$$
\Delta E_{i} = -2z_{i}\left(\sum_{j = 1}^{n}J_{ij}z_{j} + h_{i}\right)
$$

其对应代码为：

此过程相当于一次基于局部启发式的“贪心搜索后局部优化”，提升最终态对目标Hamiltonian基态的逼近能力。

图2即为算法的核心流程图，这一流程融合了经典贪心算法的快速收敛能力与量子门集的表达能力，最终构建出一条具有较优能量期望值的Clifford电路。该方法能在本问题的资源下获得良好的性能表现。

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-05/27a73631-75f1-46fd-9494-9a373d523e6b/385e2a7e8c469a8a8da84a3d61e2708b920478751e3440d3f18386611079b46e.jpg)  
图2 算法流程图

# 3.5代码结构说明

我们的核心代码主要包含以下结构：

3.5 代码结构说明我们的核心代码主要包含以下结构：1. solve(nqubit, Q_triu): 主入口函数，调用example2构建电路；2. example2(nqubit, Q_triu, select_num=None, repeat=1): 主优化电路生成逻辑；3. gradient(inaqubit, W, aqubits_k, aqubits_j): 实现未激活比特对当前划分的梯度评估；4. pos_max_grad(inaqubits, W, aqubits_k, aqubits_j): 选取具有最大梯度的比特；5. add_gate(q1, q2): 用于模拟  $e^{\frac{i\pi}{4} YZ}$  门的Clifford门组合；6. Circuit, Simulator, Hamiltonian等来自MindQuantum的类完成线路搭建与模拟。上述函数调用关系如下：solve()  - example2()  - gradient()  - pos_max_grad()  - add_gate()本方案在构造方式上借鉴了ADAPT- Clifford框架，针对实际项目引入如下关键改进：

本方案在构造方式上借鉴了ADAPT- Clifford框架，针对实际项目引入如下关键改进：

1. 将门构造改为Clifford门  $e^{\frac{i\pi}{4} YZ}$  ，相比只用简单的X门提升巨大；2. 对于初值的选定进行优化，在改进效率的基础上进一步提升；3. 相比ADAPT-Clifford源码增加能量翻转精化阶段，进一步优化线路输出质量；通过这一系列方法，算法即可成功生成适应不同问题规模的高效量子线路。

# 4结果与分析

根据研究方案和我们的实验得出结论，我们在公开测试集和平台私人数据集上对我们所设计的基于Clifford门的量子组合优化算法进行了评估。算法的核心在于利用贪心梯度驱动的线路生长策略和贪心比特翻转能量最小化这两步贪心方法，在MindQuantum的稳定子模拟器上高效地构建并评估量子线路，以求解最大割的组合优化问题。

测试结果显示，我们的方法在多个中等规模的最大割问题上取得了较优的能量期望值表现。具体而言，在本地测试数据集上，我们的算法最高获得了94785.2738分的成绩。

在平台私人数据集上我们最高达到了179114.1561分。

同时我们关注到初始划分为两边的点fqubit和qpair的选取对结果存在一定影响。我们在平台私人数据集上进行了实验，fqubit和qpair都随机选取结果如下：

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-05/27a73631-75f1-46fd-9494-9a373d523e6b/e9b076b23182c78febf776b7bb2b8ae853cb0fb676bf830088d3085cacd4b3ee.jpg)  
图3 私人数据集上随机初始测试结果图

我们可以看到随机选取初始值的话分数分布的方差是很大的，平均集中在178000以下，但是我们选取边权重和最大和最小点的点作为初始两点可以将结果稳定在一个较好的数值，该方法在私人数据集中我们测试结果为178738.1721，比一般随机选取方法更稳定且更有优势。而且这种选取方法在公开数据集中我们也提升了大约1000分。

在最后贪心比特翻转能量最小化算法操作中，我们若消融掉该操作，本地测试分数将降低2000多分，可见我们算法改进的有效性。

我们也运行了启发式蚁群算法求解Maxcut问题，但是其运行时间和效果还是不如ADAPT- Clifford贪心方法。贪心方法优势在于简单快速且适配于量子线路生成。

表1 公开数据集上算法改进效果图  

<table><tr><td>模型</td><td>本地分数</td></tr><tr><td>Baseline（模板）</td><td>89198.8955</td></tr><tr><td>Adapt-Clifford算法（随机初始值）</td><td>91636.6574</td></tr><tr><td>Adapt-Clifford算法（随机初始值）+贪心翻转能量最小化</td><td>93736.3465</td></tr><tr><td>Adapt-Clifford算法（最大最小边权和划分初始值）+贪心翻转能量最小化</td><td>94785.2738</td></tr></table>

由上表可见我们的改进是很有效果的，在私人数据集上也是效果显著。

综上所述，我们所提出的两段式贪心算法在准确性、稳定性上均展现出显著优势，为基于Clifford门的量子线路优化提供了切实可行的构建框架。

# 5 参考文献

[1] Preskill J. Quantum computing in the NISQ era and beyond[J]. Quantum, 2018, 2: 79. DOI:10.22331/q- 2018- 08- 06- 79. [2] Farhi E, Goldstone J, Gutmann S. A quantum approximate optimization algorithm[J]. arXiv preprint arXiv:1411.4028, 2014. [3] MindSpore Quantum Team. MindQuantum Documentation[EB/OL]. 2023. Available: https://www.mindspore.cn/mindquantum[4] Nielsen M A, Chuang I L. Quantum computation and quantum information: 10th anniversary edition[M]. Cambridge: Cambridge University Press, 2010. [5] Muñoz- Arias M H, Kourtis S, Blais A. Low- depth Clifford circuits approximately solve MaxCut[J]. Physical Review Research, 2024, 6(2): 023294.