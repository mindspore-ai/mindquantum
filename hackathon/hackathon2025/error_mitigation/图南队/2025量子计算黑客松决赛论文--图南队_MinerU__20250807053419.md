# 2025年量子黑客松错误缓释赛道-决赛答题文档

# 摘要

本论文构建并评估了一套针对噪声中等规模量子设备（NISQ）的通用量子误差缓解（QEM）框架。任务目标是利用含噪模拟数据估计一个6比特一维Ising模型的时间演化后自旋期望值。针对噪声带来的挑战，我们实现并对比了三类主流QEM策略：零误差外推（Zero Noise Extrapolation, ZNE）、Clifford数据回归（Clifford Data Regression, CDR）和概率误差消除（Probabilistic Error Cancellation, PEC），并结合读取误差校正、CZ相位补偿与泡利旋转等关键辅助技术提升整体性能。本框架引入了动态校准矩阵优化机制，以矫正由读取误差与门级相关噪声共同引起的系统性偏移；并设计了基于电路折叠的参数化线路构造方法以支持ZNE外推过程。大量实验表明，结合泡利旋转和相位补偿的ZNE策略在多源干扰下依然能实现接近理论值的高保真估计。同时，我们还进行了消融实验以量化各技术组件的贡献，并评估采样代价与精度之间的权衡关系。实验结果验证了本方法在NISQ时代量子算法中的实用潜力，并为有限资源条件下的误差缓解方法选择提供了实证依据。

由于本题的数据不足，许多错误缓释方法失效。为了验证不同错误缓释方法之间的差异，我们额外扩充数据，针对一个6比特一维Ising模型的含时演化为例，要求构造错误缓解算法来计算演化后单比特Z和Y方向的平均自旋期望值。论文探讨了多种量子线路构建方案，包括基于理想CZ门的变分优化法、基于含噪CZ门的变分优化法以及Trotter分解法。针对这些线路在含噪模拟器上的运行，论文实现并对比了多种量子误差缓解（QEM）技术，如零误差外推（ZNE）结合泡利旋转（PT）和CZ相位补偿、Clifford数据回归（CDR）以及概率误差消除（PEC），并分析了各种方案的优劣以及实验细节，最终选出最优搭配方案以获得接近理论值的期望结果。结合Pauli Twirling与读取校正等技术，实现含噪模拟下高保真度的观测值恢复。实验结果表明，本项目构建的“噪声标定一错误缓解一含噪模拟”一体化流程，在多源噪声干扰下仍能逼近理论演化值，为NISQ时代下的实用量子算法设计提供了可行路径。

关键字：读取矫正 错误缓解 NISQ

# Contents

# 日录

# 一、问题背景

1.1样例代码 11.2数据与样例代码说明 21.3判题与评分标准 21.4黑客松代码调试环境 3二、问题分析 8三、解决方案 83.1本文术语规范 83.2读取矫正 93.2.1读取矫正与采样优化 93.2.2读取矫正动态参数优化器 113.3误差缓解方案 123.3.1零误差外推方案(ZNE) 133.3.2概率误差消除方案(PEC) 153.3.3Clifford数据回归方案（CDR) 163.3.4CZ相位补偿 183.3.5泡利旋转（PauliTwirling) 19四、总结及展望 204.1实验结果 204.2实验总结 22参考文献 23

# 一、问题背景

在超导量子计算中，误差率的具体数值因硬件和实验条件不同而有所差异，但通常范围如下：1．单量子门误差率：一般在  $10^{- 4}$  到  $10^{- 3}$  之间，即  $0.01\%$  到  $0.1\%$  。2．双量子门误差率：通常在  $10^{- 3}$  到  $10^{- 2}$  之间，即  $0.1\%$  到  $1\%$  。3．读出误差率：一般在  $10^{- 2}$  到  $10^{- 1}$  之间，即  $1\%$  到  $10\%$  。

可以看出量子读出噪声是造成量子错误的一个重要来源，当前处理读出噪声的优化技术有基于矩阵[1]、机器学习、贝叶斯估计[1]的矫正方法等。

给定测量得到的量子态向量  $\vec{p}_{\mathrm{noisy}}$  ，设计算法求出矫正后的概率向量  $\vec{p}_{\mathrm{calibrated}}$ $\vec{p}_{\mathrm{calibrated}}$  越接近理想分布  $\vec{p}_{\mathrm{ideal}}$  得分越高，此外，根据训练算法所用数据量给予一定奖励分数，所用数据量越少则奖励分数越高。

1. 最简单的基于矩阵的测量误差模型可以描述为：  $\vec{p}_{\mathrm{noisy}} = M\vec{p}_{\mathrm{ideal}}$  ，其中  $\vec{p}_{\mathrm{ideal}}$  为理想分布，  $\vec{p}_{\mathrm{noisy}}$  为含误差的测量结果，即理想分布  $\vec{p}_{\mathrm{ideal}}$  经过Calibration Matrix  $M$  的作用得到含测量误差的分布  $\vec{p}_{\mathrm{noisy}}$  。（Calibration Matrix  $M$  的测量构建见附录）

2. 通常情况下，Calibration Matrix  $M$  是非奇异的，对Calibration Matrix  $M$  求逆并乘上含噪声的测量结果即可求得理想分布：  $\vec{p}_{\mathrm{ideal}} = M^{-1}\vec{p}_{\mathrm{noisy}}$  。然而，矩阵求逆方法可能会产生负值或超出概率范围的结果，这在物理上是不合理的。因此，研究人员基于该模型又发展出IBU（Iterative Bayesian Unfolding）[1,2]等方法。

3. Calibration Matrix 的维度  $2^n$  呈指数增长。测量Calibration Matrix需要的“校准电路”数量也将增大，这会导致测量过程变得漫长，消耗的量子资源也会难以接受。为了迎接规模问题带来的挑战，有学者提出分而治之的方法[3,4]。极端的分而治之容易忽略串扰（crosstalk）关联噪声（correlated noise）等带来的量子错误。因此，需要权衡关联量子错误和规模问题。我们鼓励使用更小量子资源求解该题的方案。

# 1.1样例代码

hackathon- readout/

- samples/- circuit #目标线路- data #数据集- answer.py #赛题样例代码- answer2.py #赛题样例代码- run.py #判题系统的判题脚本，用于选手调试程序- README.md #赛题说明

# 1.2 数据与样例代码说明

1. 本赛题提供 9 比特“基本线路”和“目标线路”测量结果作为测试数据，每个线路都进行了 50000 次重复实验，即每个线路都有 50000 个独立的 9 比特测量结果。

2. 基本线路共 512 个，具体为将比特分别制备在  $\{000000000, 00000001, 000000010, \ldots , 111111111\}$  态后的测量结果。测量结果是比特排列顺序为  $[q8, q7, q6, q5, q4, q3, q2, q1, q0]$  的  $\{0, 1\}$  比特串。以 000000010 态为例，即在  $q1$  上作用 X 门，然后测量所有比特。基本线路的测量数据在文件路径 /samples/data/bitstrings_base.npz 的 'arr_0' 中，数据为形如 [512, 50000, 9] 的三维数组，分别对应量子态、重复次数和不同比特。

3. 目标线路共有 6 个，包含 1 个 9 比特 GHZ 态制备线路和 5 个随机线路。具体量子线路的路径为：/samples/circuit，其中包含线路图和量子指令集两种表示形式以供参赛选手查看。测量结果在 /samples/data/bitstrings_circuit_{i}.npz 文件中的 'arr_0' 变量中，数据为形如 [50000, 9] 的二维数组，分别对应重复次数和不同比特，比特排列顺序同样为  $[q8, q7, q6, q5, q4, q3, q2, q1, q0]$ 。

4. 选手在作答时需通过样例代码 answer.py 中的函数 get_data(state, qubits_number_list, random_seed) 获取基本线路的测量数据，用于训练修正算法。该函数会对所用数据量进行计数，并影响最终得分。在提交的答案中绕过该函数以其他方式获取“基本线路数据”将视为作弊行为。

5. 选手可自由获取目标线路和测量数据用于训练修正算法，但需保证修正算法的通用性。当选手利用“目标线路的测量数据”进行预训练时，主办方会将该训练后的算法用“同一批次采集的其他量子线路测量数据”进行测试，当结果差异较大时，酌情进行减分或取消成绩。

6. 'answer.py' 和 'answer2.py' 分别为“逆矩阵”和“IBU”方法的解答案例，供选手参考。

# 1.3 判题与评分标准

总分 = 基础分 + 奖励分

# (1) 基础分说明

$$
\mathrm{score} = 1000 \times \left(1 - \frac{1}{2} \sum_{i = 1}^{k} |P_i - Q_i|\right) \tag{1}
$$

其中

-  $P_i$  是算法得到的目标向量  $\vec{p_a}$  中的元素， $Q_i$  是理想分布  $\vec{p}_{\mathrm{ideal}}$  中的元素。

- \(TVD = \frac{1}{2} \sum_{i = 1}^{k} |P_{i} 
- Q_{i}|\) 的值在 0 到 1 之间，0 表示两个分布完全相同，1 表示完全不重叠。

# (2) 奖励分说明

$$
\mathrm{final~score} = 1000 \times \left(1 - \frac{1}{2} \sum_{i = 1}^{k} |P_{i} 
- Q_{i}| + \alpha\right) \tag{2}
$$

1. 用到全部“512 个量子态  $\times 9$  比特  $\times 50000$  个重复结果”的，只有基础分；2.  $\alpha$  与 bit-string 数量呈线性负相关，取值范围为  $[0 \sim 0.005]$  。具体计算公式为：

$$
\alpha = 0.005 \times \frac{50000 \times 512 \times 9 - \texttt{train\_sample\_num}}{50000 \times 512 \times 9}
$$

其中，train_sample_num 表示所使用的基本线路测量结果的数据总量。每一个量子态、每一个比特、每一个测量结果被计为 1 个数据点。例如：若获取 2000 个初态为 '000000010' 的  $[q2, q1, q0]$  三个比特的测量结果，则对应的数据量为：

$$
2000 \times 1 \times 3 = 6000
$$

# 1.4 黑客松代码调试环境

点击链接进入 JupyterLab 环境 中调试代码

# 问题背景介绍

我们以 two qubit 为例子，介绍 Quantum Readout Calibration

一个 2 比特的量子态可以表示为一个 4 维复数向量：

$$
|\psi \rangle = \begin{pmatrix} \alpha \\ \beta \\ \gamma \\ \delta \end{pmatrix}
$$

计算基（computational basis）上展开该量子态：

$$
|\psi \rangle = \alpha |00\rangle +\beta |01\rangle +\gamma |10\rangle +\delta |11\rangle
$$

对量子态进行测量。测量过程将量子态投影到计算基上。具体来说，测量结果与计算基的状态相关：

- 测量结果为  $|00\rangle$  的概率为  $p_{00} = |\alpha |^{2}$ - 测量结果为  $|01\rangle$  的概率为  $p_{01} = |\beta |^{2}$

·测量结果为  $|10\rangle$  的概率为  $p_{10} = |\gamma |^2$  ·测量结果为  $|11\rangle$  的概率为  $p_{11} = |\delta |^2$  设理想的概率向量为：

$$
\vec{p}_{\mathrm{ideal}} = \left( \begin{array}{c}p_{00}\\ p_{01}\\ p_{10}\\ p_{11} \end{array} \right)
$$

# 校准矩阵（CalibrationMatrix）

理想的量子态向量，因为读出噪声（readout errors）成为带有噪声的概率向量  $\vec{p}_{\mathrm{noisy}}$  。我们把读出噪声对量子态的影响用校准矩阵（Calibration Matrix）描述  $M$

$$
\vec{p}_{\mathrm{noisy}} = M\vec{p}_{\mathrm{ideal}}
$$

将矩阵和向量相乘，得到：

$$
\vec{p}_{\mathrm{noisy}} = M\left( \begin{array}{c}p_{00}\\ p_{01}\\ p_{10}\\ p_{11} \end{array} \right) = \left( \begin{array}{cccc}M_{00} & M_{01} & M_{02} & M_{03}\\ M_{10} & M_{11} & M_{12} & M_{13}\\ M_{20} & M_{21} & M_{22} & M_{23}\\ M_{30} & M_{31} & M_{32} & M_{33} \end{array} \right)\left( \begin{array}{c}p_{00}\\ p_{01}\\ p_{10}\\ p_{11} \end{array} \right)
$$

展开后，每个元素为：

$$
\vec{p}_{\mathrm{noisy}} = \left( \begin{array}{c}p_{\mathrm{noisy,00}}\\ p_{\mathrm{noisy,01}}\\ p_{\mathrm{noisy,10}}\\ p_{\mathrm{noisy,11}} \end{array} \right) = \left( \begin{array}{c}M_{00}p_{00} + M_{01}p_{01} + M_{02}p_{10} + M_{03}p_{11}\\ M_{10}p_{00} + M_{11}p_{01} + M_{12}p_{10} + M_{13}p_{11}\\ M_{20}p_{00} + M_{21}p_{01} + M_{22}p_{10} + M_{23}p_{11}\\ M_{30}p_{00} + M_{31}p_{01} + M_{32}p_{10} + M_{33}p_{11} \end{array} \right)
$$

其中  $M$  的形式为：

$$
M = \left( \begin{array}{llll}M_{00} & M_{01} & M_{02} & M_{03}\\ M_{10} & M_{11} & M_{12} & M_{13}\\ M_{20} & M_{21} & M_{22} & M_{23}\\ M_{30} & M_{31} & M_{32} & M_{33} \end{array} \middle) \right.
$$

矩阵元素含义：从计算基  $|j\rangle$  得到测量结果  $|i\rangle$  的概率。

·第一行：

-  $M_{00}$  ：制备  $|00\rangle$  ，测量得到  $|00\rangle$  的概率。

-  $M_{01}$ : 制备  $|01\rangle$ , 测量得到  $|00\rangle$  的概率。-  $M_{02}$ : 制备  $|10\rangle$ , 测量得到  $|00\rangle$  的概率。-  $M_{03}$ : 制备  $|11\rangle$ , 测量得到  $|00\rangle$  的概率。

- 第二行：

-  $M_{10}$ : 制备  $|00\rangle$ , 测量得到  $|01\rangle$  的概率。-  $M_{11}$ : 制备  $|01\rangle$ , 测量得到  $|01\rangle$  的概率。-  $M_{12}$ : 制备  $|10\rangle$ , 测量得到  $|01\rangle$  的概率。-  $M_{13}$ : 制备  $|11\rangle$ , 测量得到  $|01\rangle$  的概率。

- 第三行：

-  $M_{20}$ : 制备  $|00\rangle$ , 测量得到  $|10\rangle$  的概率。-  $M_{21}$ : 制备  $|01\rangle$ , 测量得到  $|10\rangle$  的概率。-  $M_{22}$ : 制备  $|10\rangle$ , 测量得到  $|10\rangle$  的概率。-  $M_{23}$ : 制备  $|11\rangle$ , 测量得到  $|10\rangle$  的概率。

- 第四行：

-  $M_{30}$ : 制备  $|00\rangle$ , 测量得到  $|11\rangle$  的概率。-  $M_{31}$ : 制备  $|01\rangle$ , 测量得到  $|11\rangle$  的概率。-  $M_{32}$ : 制备  $|10\rangle$ , 测量得到  $|11\rangle$  的概率。-  $M_{33}$ : 制备  $|11\rangle$ , 测量得到  $|11\rangle$  的概率。

# 例子

举个例子，假设我们有以下测量误差概率：

- 从  $|00\rangle$  转换到  $|00\rangle$  的概率是0.9，转换到  $|01\rangle$  的概率是0.05，转换到  $|10\rangle$  的概率是0.03，转换到  $|11\rangle$  的概率是0.02。- 从  $|01\rangle$  转换到  $|00\rangle$  的概率是0.1，转换到  $|01\rangle$  的概率是0.8，转换到  $|10\rangle$  的概率是0.05，转换到  $|11\rangle$  的概率是0.05。- 其他行可以类似定义。最终的M矩阵为：

$$
M = \left( \begin{array}{llll}0.9 & 0.1 & 0.02 & 0.01 \\ 0.05 & 0.8 & 0.03 & 0.02 \\ 0.03 & 0.05 & 0.9 & 0.05 \\ 0.02 & 0.05 & 0.05 & 0.92 \end{array} \right)
$$

# 指数挑战

当系统的量子比特数目增大时，会带来以下几个主要问题：

1. Calibration Matrix 的维度呈指数增长  $2^{n}$  。测量 Calibration Matrix 需要的“校准电路”数量也将增大，这会导致测量过程变得漫长，消耗的量子资源也会难以接受。2. 由于 M 的规模呈指数增长，存储这样一个矩阵所需的内存也会迅速增加，可能会超出当前计算设备的存储能力。3. 校准的复杂度增加。

# 实验上如何通过测量构造 Calibration Matrix

前面我们假设已经知道 Calibration Matrix，展示了它的影响。

现实中，Calibration Matrix 需要通过实验测量得到，这部分我们展示如何从实验中获得 Calibration Matrix。

测量该矩阵的方法包括构建一组称为“校准电路”的量子电路

·对于  $n$  量子比特系统，我们必须构建  $2^{n}$  个校准电路。·该电路生成系统的所有相应计算基态

# 例子：2 Qubits 实验构造

- 2 量子比特系统初始化在量子态  $|00\rangle$  。- 计算基  $(|00\rangle , |01\rangle , |10\rangle , |11\rangle)$  的态有  $2^{2}$  个。- 为了构建校准矩阵，我们必须构建  $2^{2}$  个校准电路，我们使用 X 门来准备这 4 个量子比特配置。- 在读出后，我们得到每个校准电路在不同基的次数。

2 量子比特系统初始化在量子态  $|00\rangle$

- 测量得到在不同基底上的次数- 计算相应的概率

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/d5ec3be999c2d37bc71da0fcc751cd65f75158948cd67151debd4f87bccd3f74.jpg)

2量子比特系统，经过线路得到量子态  $|01\rangle$

测量得到在不同基底上的次数- 计算相应的概率

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/6b8d7c424bd2944cd6d31290b3c903ef776ef67d572072269010dead9d0e3f7f.jpg)

2量子比特系统，经过线路得到量子态  $|10\rangle$

测量得到在不同基底上的次数- 计算相应的概率

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/179b11e0a3640bdb2c11a6c8c3bbff19bbb9c6beb6cd22c73b8808a04f8797e9.jpg)

2量子比特系统，经过线路得到量子态  $|11\rangle$

测量得到在不同基底上的次数- 计算相应的概率

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/659498d71663450b9a11c2ecc60a571d6d6a3e1a281b47d52a4291f2a423e9ad.jpg)

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/581e4f00ce8e48e8d423aeb7dabd2967779fe07c0b5b73eeb4c6f44759cf9175.jpg)  
图1 小端序编码示例。

将这些列组合成 Calibration Matrix

$$
M_{2Q} = \left( \begin{array}{cccc}0.851125 & 0.126375 & 0.018500 & 0.001500 \\ 0.127875 & 0.853000 & 0.002375 & 0.017125 \\ 0.018625 & 0.002250 & 0.851375 & 0.124750 \\ 0.002375 & 0.018375 & 0.002375 & 0.856625 \end{array} \right)
$$

# 二、问题分析

# 三、解决方案

本节分为三块内容，首先我们介绍读取矫正、机器学习、误差缓解的方法。

# 3.1 本文术语规范

在此之前我们需要做一些约定。在本文中我们遵循小端序 (little- endian) 规范，如图1所示，与mindquantum、qiskit等不同。

小端序规定第一个比特(量子线路中最上面的比特)位于bitstring的最左侧位置，而大端序则相反。认清这一点十分重要，往往在一开始就需要挑明，后面在计算Pauli串的期望时就与这条规定相关。另外线路的酉矩阵也需要根据这个约定来写。

另外，我们使用  $H, X, Y, Z$  来表示Hadamard门和Pauli- X、Y、Z矩阵。

$$
H = \frac{1}{\sqrt{2}}\left[ \begin{array}{cc}1 & 1 \\ 1 & -1 \end{array} \right], \quad X = \left[ \begin{array}{cc}0 & 1 \\ 1 & 0 \end{array} \right], \quad Y = \left[ \begin{array}{cc}0 & -i \\ i & 0 \end{array} \right], \quad Z = \left[ \begin{array}{cc}1 & 0 \\ 0 & -1 \end{array} \right]. \tag{3}
$$

全文使用 Dirac 符号， $|\ast \rangle$  表示一个列向量， $\langle \ast \rangle$  表示一个行向量。

# 3.2 读取矫正

# 3.2.1 读取矫正与采样优化

由于读取噪声的影响，采样时比特会有固定的概率发生  $0\to 1$  或  $1\to 0$  的翻转。而每个比特的翻转都会导致Puali串的观测值变号。

以两比特情况举例，假设要测量  $ZZ = \left[ \begin{array}{cccc}1 & 0 & 0 & 0\\ 0 & - 1 & 0 & 0\\ 0 & 0 & - 1 & 0\\ 0 & 0 & 0 & 1 \end{array} \right]$  算符的期望，而此时两比特量子态为  $|00\rangle$  ，那么在这个状态下，  $ZZ$  期望为1，即对角线第一个矩阵元。在某一次采样中，第一个比特发生了翻转，于是我们测到的bitstring为10，而  $|10\rangle$  态对应的  $ZZ$  期望为- 1，这便导致了错误的发生。但是如果两个比特都发生翻转，最终测到的是11，而  $|11\rangle$  态对应的  $ZZ$  期望为1，这并不会导致错误。

# （1）张量积读取校准原理

下面我们开始对读取过程进行数学建模。在理想读取没有误差的情况下，  $N$  比特观测量  $Z^{\otimes N}$  的测量值可写为

$$
\begin{array}{rl} & {\left\langle Z^{\otimes N}\right\rangle = \mathrm{Tr}(\rho Z^{\otimes N})}\\ & {\qquad = \left[ \begin{array}{ll}1, & -1 \end{array} \right]^{\otimes N}\cdot \mathrm{diagonal}(\rho)}\\ & {\qquad = \left[ \begin{array}{ll}1, & -1 \end{array} \right]^{\otimes N}\cdot |p\rangle} \end{array} \tag{4}
$$

其中，  $\rho$  为密度矩阵，diagonal  $(\rho)$  表示密度矩阵的对角元素，也就是bitstring的测量概率分布，后面记为  $|p\rangle$  。当读取比特翻转误差  $p(|0\rangle ||1\rangle) = p(|0\rangle ||1\rangle) = 0.05$  时，  $|0\rangle$  和  $|1\rangle$  两个量子态的读取保真度为  $F_{0} = F_{1} = 0.95$  ，所有比特都相同。则此时  $N$  比特观测量  $Z^{\otimes N}$  的测量值可写为

$$
\begin{array}{r l} & {\left[ \begin{array}{l l}{1,} & {-1} \end{array} \right]^{\otimes N}\cdot |p^{e}\rangle = \left[ \begin{array}{l l}{1,} & {-1} \end{array} \right]^{\otimes N}\cdot \left[ \begin{array}{l l}{F_{0}} & {1 - F_{1}}\\ {1 - F_{0}} & {F_{1}} \end{array} \right]^{\otimes N}\cdot |p\rangle}\\ & {\qquad = \left[ \begin{array}{l l}{2F_{0} - 1,} & {1 - 2F_{1}} \end{array} \right]^{\otimes N}\cdot |p\rangle} \end{array} \tag{5}
$$

其中  $|p^{e}\rangle$  表示存在读取误差时测量bitstring的概率分布。它与无误差时的概率分布之间的关系为

$$
\begin{array}{rl} & {|p\rangle = \left(\left[ \begin{array}{cc}F_0 & 1 - F_1\\ 1 - F_0 & F_1 \end{array} \right]^{-1}\right)^{\otimes N}\cdot |p^m\rangle}\\ & {\quad = \left(\frac{1}{F_1 + F_0 - 1}\left[ \begin{array}{cc}F_1 & F_1 - 1\\ F_0 - 1 & F_0 \end{array} \right]\right)^{\otimes N}|p^m\rangle} \end{array} \tag{6}
$$

由带误差的概率分布计算得到无读取误差时观测量的期望为：

$$
\begin{array}{rl} & {\left[ \begin{array}{ll}1, & -1 \end{array} \right]^{\otimes N}\cdot |p\rangle}\\ & {= \left[ \begin{array}{ll}1, & -1 \end{array} \right]^{\otimes N}\cdot \left(\frac{1}{F_1 + F_0 - 1}\left[ \begin{array}{ll}F_1 & F_1 - 1\\ F_0 - 1 & F_0 \end{array} \right]\right)^{\otimes N}\cdot |p^m\rangle}\\ & {= \left(\left[\frac{F_1 - F_0 + 1}{F_1 + F_0 - 1},\quad \cdot \frac{F_1 - F_0 - 1}{F_1 + F_0 - 1}\right]\right)^{\otimes N}\cdot |p^m\rangle .} \end{array} \tag{7}
$$

以上便是读取误差矫正的数学原理

读取矫正方案经测试，读取误差会对参数的拟合结果造成影响。在实验中，我们可以通过特定量子线路标定出比特的读取保真度，进而进行读取矫正。

最简单的基于矩阵的测量误差模型可以描述为：  $\vec{p}_{\mathrm{noisy}} = M\vec{p}_{\mathrm{ideal}}$  ，其中  $\vec{p}_{\mathrm{ideal}}$  为理想概率分布，  $\vec{p}_{\mathrm{noisy}}$  为含误差的测量结果，即理想分布  $\vec{p}_{\mathrm{ideal}}$  经过校准矩阵 (Calibration Matrix)  $M$  的作用得到含测量误差的分布  $\vec{p}_{\mathrm{noisy}}$  。单比特校准矩阵的定义为

$$
M = \left[ \begin{array}{cc}F_0 & 1 - F_1 \\ 1 - F_0 & F_1 \end{array} \right], \tag{8}
$$

其中  $F_0, F_1$  为  $|0\rangle , |1\rangle$  态读取保真度。

·Note：在实际采样测量过程中，我们每次得到的是bitstring，对应的本征值在无误差时是  $\pm 1$  ，有误差时是  $\left(\frac{F_1 - F_0 + 1}{F_1 + F_0 - 1}\right)^{Z_0}\left(\frac{F_1 - F_0 - 1}{F_1 + F_0 - 1}\right)^{N - Z_0}$  ，其中  $Z_0$  是该 bitstring 中0 的个数。这样每做一次测量便得到一个本征值，对全部采样结果取平均便得到了读取矫正后的观测量期望。

# (2）读取保真度标定

图2展示了我们用来标定读取保真度的量子线路。需注意，我们忽略了两比特关联读取误差，将各自读取的误差视为独立的，根据测量结果得到每个比特  $|0\rangle (|1\rangle)$  态读取保真度  $F_0(F_1)$  。两比特校准矩阵可以直接由矩阵张量积得到  $M_{2q} = M_{q_0}\otimes M_{q_1}$  。

通常情况下，校准矩阵  $M$  是非奇异的，对  $M$  求逆并乘上含噪声的测量结果即可求得理想分布：  $\vec{p}_{\mathrm{ideal}} = M^{- 1}\vec{p}_{\mathrm{noisy}}$  。

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/73c848d7faf4c4d9e16ed0b41008427a4874dbc0fce2e81b4bae3d8c9e391dc1.jpg)  
图2 标定读取保真度的量子线路图，左图制备  $|00\rangle$  后直接测量，右图制备  $|11\rangle$  后测量。

# 3.2.2 读取矫正动态参数优化器

根据我们的实验观察，本赛题的所给数据中，不仅包含量子门的读取误差，还包含了量子门噪声、退相干噪声，包括能量弛豫（  $T_{1}$  ）与相位散度（  $T_{2}$  ）过程。这些错误不仅影响量子态的演化，还会对最终的测量分布造成系统性偏差，使得测量误差修正方法中的张量积校正策略不再准确。

传统的测量误差校正方法通常假设测量误差满足独立性，进而对每个量子比特构造测量误差矩阵（measurement fidelity matrix），例如  $MF_{0}$  与  $MF_{1}$ ，再对多个量子比特取张量积形成整体校正矩阵。然而，退相干过程具有时间相关性，且在电路执行过程中持续发生，其导致测量分布不仅依赖于测量误差矩阵，还受到前序门操作、测量延迟等因素的共同影响，从而引入复合噪声偏移。因此，仅依赖静态测量误差矩阵进行张量积修正可能存在过度或欠修正的问题，需要设计一种具有“弹性调节能力”的校正机制来吸收上述不可建模噪声源。

为了解决上述问题，我们引入一个基于测量误差矩阵的动态校正系数优化器。其基本思想是：在原有张量积形式的基础上，对每个量子比特的测量误差矩阵引入两个连续可调的缩放因子  $i,j\in [0.9,1.0]$ ，对原始矩阵进行缩放，从而在微调范围内寻找更能拟合真实分布的“等效校正矩阵”。对第  $q$  个量子比特，其等效测量校正矩阵表示为：

$$
MF_{q}^{\mathrm{eff}} = \left[i_{q}\cdot MF_{0}^{(q)},j_{q}\cdot MF_{1}^{(q)}\right],\quad i_{q},j_{q}\in [0.9,1.0] \tag{9}
$$

其中，  $MF_{0}^{(q)}$  与  $MF_{1}^{(q)}$  分别表示第  $q$  个量子比特在“测  $0^{\circ}$ ”和“测  $1^{\circ}$ ”状态下的测量误差矩阵列向量，  $i_{q}$  与  $j_{q}$  为待优化的缩放因子。

对整个系统进行校正时，构造如下张量积形式：

$$
MF^{\mathrm{eff}} = MF_{0}^{\mathrm{eff}}\otimes MF_{1}^{\mathrm{eff}}\otimes \dots \otimes MF_{n = 1}^{\mathrm{eff}} \tag{10}
$$

将其用于逆向修正得到校正后的分布：

$$
\hat{p}_{\mathrm{corr}} = \left(MF^{\mathrm{eff}}\right)^{-1}\cdot p_{\mathrm{measured}} \tag{11}
$$

# (1) 优化目标函数构建

为了优化参数  $i_{q}, j_{q}$ ，我们需要构造一个损失函数  $\mathcal{L}(i,j)$  衡量校正分布  $\hat{p}_{\mathrm{corr}}$  与参考分布  $p_{\mathrm{ref}}$  之间的偏差。参考分布可以来源于模拟器输出或理论分析结果。我们使用总变差距离（Total Variation Distance, TVD）作为损失函数：

$$
\mathcal{L}(i,j) = D_{\mathrm{TVD}}(\hat{p}_{\mathrm{corr}}, p_{\mathrm{ref}}) = \frac{1}{2} \sum_{x} \left| \hat{p}_{\mathrm{corr}}(x) - p_{\mathrm{ref}}(x) \right| \tag{12}
$$

该指标具有清晰的概率意义，即两个分布之间的最大区分概率。

# (2) 优化器选择与数学求解方法

由于参数空间维度较低（每个量子比特2个参数），且目标函数通常连续、可导，适合使用拟牛顿法中的L- BFGS- B优化器进行求解。该方法支持变量约束，能在高精度下高效收敛。优化问题形式化如下：

$$
\begin{array}{rl} & {\underset {i_0,j_0,\ldots ,i_{n - 1},j_{n - 1}}{\min}\mathcal{L}(i,j)}\\ & {\mathrm{s.t.}0.9\leq i_q\leq 1.0,0.9\leq j_q\leq 1.0,\forall q} \end{array} \tag{13}
$$

该优化问题可以通过Python的scipy.optimize.minimize接口调用method='L- BFGS- B'进行数值求解，梯度可自动估计。最终迭代出来的结果是：  $i = 0.9983, j = 0.9955$  时，矫正测试分数为：9538.4797。

本小节针对张量积测量误差校正方法在存在退相干噪声时精度不足的问题，提出引入动态缩放系数的方法，通过最小化校正分布与参考分布之间的差距，优化每个量子比特的测量误差矩阵系数。该方法能够在不改变传统张量积形式的前提下显著提升校正精度，并具备良好的物理可解释性与数值稳定性，适用于NISQ时代的量子校正任务。

# 3.3 误差缓解方案

根据我们的实验观察，本赛题的所给数据中，不仅包含量子门的读取误差，还包含了量子门噪声，例如图3，结果显示8个CZ门的线路明显结果比5个和6个的差。因此，在读取矫正之外，我们还应考虑尽可能消除掉量子门噪声，使其更接近于理想结果。

为了使量子计算机成功解决现实世界中的问题，必须应对噪声挑战：由于不必要或不完美的相互作用导致基本物理组件中出现的错误。相比于容错量子计算，误差缓解技术将在NISQ时代率先发挥作用。误差缓解往往需要增加采样的成本。因此在考察对比误差缓解技术的优劣时，不能单看误差缓解的程度，采样成本也是一个重要的考虑因素。由于本题提供的实验数据有限，在实际过程中做误差缓解时会有所性能限制，为了充分探讨不同错误缓释方法的差异，我们会适当引入新的测试案例。

针对量子处理器中的噪声，有多种量子误差缓解（Quantum Error Mitigation, QEM）方法，本文实现了零误差外推（Zero Noise Extrapolation, ZNE）[5]、Clifford数据回归

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/ba51512481d3ed2a0c759b62234d10896a044da3157cdadf7f73a41499133ec3.jpg)  
图3 本赛题数据包含的读取和量子门噪声。

(Clifford Data Regression, CDR) [6, 7] 和概率误差消除（Probablistic Error Cancellation, PEC）[8- 11]三种不同的误差缓解方法，基于这三种不同的误差缓解方法，我们构建了三种不同的误差缓解方案，并选择实验效果最优的零误差外推方案作为最终实验结果。为了消除读取误差，我们还采用3.2.1中的读取误差缓解（Quantum Readout Error Mitigation, QREM）方案，在此题中不再赘述。同时，由于题目所给数据中的量子门包含相干误差，因此，除了含噪量子门的变分优化法外（训练得到的线路已经适应了量子门的所有误差），我们还对  $CZ'$  门的两个RZ相位进行补偿，并通过泡利旋转（Pauli Twirling, PT）[12]将剩余相干误差转化为泡利误差以增强QEM的效果。

# 3.3.1 零误差外推方案 (ZNE)

零误差外推（Zero Noise Extrapolation, ZNE）[9, 10, 13, 14] 误差缓解方案基于QREM、CZ相位补偿、ZNE和PT，适用于理想  $CZ$  门的变分优化法和Trotter分解法。具体方案可以被概括如下：

1. 按照3.2.1的方法标定读取误差。2. 使用题目2a中标定的a和b对所有在带噪模拟器上运行的  $CZ'$  门进行相位补偿。3. 基于线路折叠和PT构造一系列处于不同噪声水平，同时无噪声情况下等价的量子线路。4. 运行上述量子线路，并在测量后进行读取矫正。5. 使用指数函数进行噪声尺度-带噪观测值的拟合并外推得到噪声尺度为0时的预期理想观测结果。

步骤1和4的详细过程参照3.2.1。同时步骤2中的相位补偿针对线路中所有的出现的  $CZ'$  门，因此为了简化符号，我们用  $CZ'$  门指代进行相位补偿之后的含噪  $CZ'$  门。

步骤3是ZNE方法的核心，ZNE最早由文献[10]提出，其通过设计实验方法来使目标量子线路运行在一系列不同尺度的处理器噪声上，并选择适当的拟合函数  $f$  对来拟合实验观测量结果与噪声尺度的关系，并通过外推以得到零噪声下的无噪观测量估计

值，噪声水平则为一个无量纲的参数  $\epsilon$  ，当  $\epsilon = 0$  时认为没有噪声存在，对应与线路的理想观测值，当  $\epsilon = 1$  时，则对应直接在含噪量子计算机上运行目标线路的实际带噪观测结果。

扩大噪声尺度有多种方法，针对本文的量子线路，我们使用线路折叠法[5]。具体而言，线路折叠法假定量子线路由  $d$  层组成

$$
U = L_{d}L_{d - 1}\dots L_{1}, \tag{14}
$$

其中  $d$  表示线路深度，  $L_{i}$  为  $i$  层量子线路。线路折叠选择该量子线路中的  $s$  个子层进行折叠，对于每个选择的子层  $L_{i}$  ，我们将  $L_{i}L_{i}^{\dagger}$  或  $L_{i}^{\dagger}L_{i}$  作为两个新的子层，插入线路的式14中的任意位置，则可以得到新的量子线路  $U_{s}$  ，显然  $U_{s}$  与  $U$  具有相同的理想输出值，但线路深度从  $d$  增加为  $d + 2s$  ，相应的线路所感知到的噪声水平从初始  $U$  的1增加为  $1 + 2s / d$  ，由于最少需要选择一层进行折叠，因此这种噪声增加方式的最低分辨率为 $2 / d$  ，通过这种方式可以得到一系列噪声水平如下的量子线路

$$
\lambda = 1 + \frac{2s}{d},\quad s = 1,2,\dots . \tag{15}
$$

实验中，我们将一个纠缠层视作一个基本子层进行折叠，在每个噪声水平下，我们随机采样多种不同的折叠线路，并对每个折叠线路施加随机泡利旋转，并使用这些线路观测结果的平均值作为该噪声水平下的线路观测值

$$
\langle O(\epsilon)\rangle = \frac{1}{ND}\sum_{i = 1}^{N}\sum_{j = 1}^{D}\langle O_{i,j}(\epsilon)\rangle , \tag{16}
$$

其中  $N$  为折叠线路数量，  $D$  为针对每个折叠线路施加随机泡利旋转线路的数量。

对于步骤5，我们采用如下指数拟合函数

$$
f(\epsilon) = \alpha_{0}e^{\beta_{0}\epsilon} \tag{17}
$$

其中  $\alpha_{0}$  对应了零噪声的观测结果，针对每个含噪观测量  $\langle Z_i\rangle ,\langle Y_i\rangle ,i\in \{0,1,2,3,4,5\}$  我们都使用上述函数进行了零误差外推得到零误差估计值  $\langle \hat{Z}_i\rangle ,\langle \hat{Y}_i\rangle ,i\in \{0,1,2,3,4,5\}$  最后计算平均值得到

$$
\begin{array}{l}\langle Z\rangle = \frac{1}{N}\sum \langle Z_i\rangle ,\\ \langle Y\rangle = \frac{1}{N}\sum \langle Y_i\rangle . \end{array} \tag{19}
$$

在图4中，我们展示了一个用二次函数外插的数据图。

我们研究对比了线路折叠和随机插入identity门两种增大误差的方式，发现后者表现要稍微好一些。

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/78e690065ea423367a6ccccdef744e55e8d86d5b261ecf6cc53bc4da4676ef04.jpg)  
图4 ZNE使用举例。

# 3.3.2 概率误差消除方案(PEC)

概率误差消除方案(Probabilistic Error Cancellation, PEC)适用于当线路中的噪声已知时，我们可以采取一种更“聪明”的方法进行误差缓解。IBM Quantum的首席执行官Zlatko Minev博士的个人主页上有一个生动形象介绍PEC原理的PPT，请允许我们在这里援引他的PPT来做介绍。如图5所示，我们带噪声的量子器件如同一个醉鬼，还是一个瘸腿的醉鬼。他左右摇摆如同随机行走，但是由于瘸腿而具有向右的偏向性。我们一旦知道了他向左和向右移动的概率，便可以通过给他吹一阵反方向的风来抵消他的偏向性，从而保证他在一段时间后位置的期望还在原点。这么做虽是保证了位置期望在原点，但是由于我们额外增加了一个移动的不确定因素，这会使得醉鬼的位置具有更强的不确定性，也就是他水平位置的方差增大了。

在噪声模型简单的情况下，可不必使用诸如IBM文章中的稀疏Pauli- Lindblad误差模型，而是针对本题的噪声模型进行概率误差消除。实验上的具体操作步骤概括如下：

1. 按照3.2.1的方法标定读取误差；

2. 利用含噪模拟器标定退相位误差系数，标定的量子线路如图6所示；

3. 可利用含噪  $CZ'$  门的变分优化法实现含时演化量子态的制备；

4. 在含噪变分线路的基础上加上补偿相位误差的  $Z$  门，由于线路中有15个  $CZ$  门，需要运行30次不同的线路（每个  $CZ$  门的两个比特各自单独测一次）得到30个不同的期望值，根据标定出来的退相位误差率  $\lambda$ ，进行概率反推得到理想的期望值。

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/718e4894a075bb1e6edf6fd85bfa9b81081929934ce7554156ea79a9d76ee031.jpg)  
图5 PEC形象的理解。来源：https://www.zlatko-minev.com/blog/quantum-error-mitigation-bss23.

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/5cfe6804fef83deda13fd77c589a735522e119f9d3b01b8f164a9cdbcada900c.jpg)  
图6 标定退相位噪声的量子线路。

PEC的一大优势便是数学上的完备性。如果噪声模型可以被准确知道，那么PEC理论上可以做到对精确值的无偏估计。不过这个无偏估计需要无穷多的采样，实际上并不可行。实际使用PEC时，我们往往通过蒙特卡洛采样的方式近似实现无偏估计。另一个常见的方式是只采样显著误差集，也就是针对误差出现概率最大的线路进行采样，而误差出现概率小的线路就不管了。PEC的劣势也很明显。PEC方法虽然具有数学上的完备性，但由于代价过大，不可扩展等原因实际使用价值不如ZNE。

# 3.3.3 Clifford数据回归方案（CDR）

Clifford数据回归方案（Clifford Data Regression，CDR）算是第一个尝试使用机器学习的方式进行误差缓解的技术。主要需要创建一个训练数据集，其中  $\mathbf{y}_{\mathrm{err}}$  和  $\mathbf{y}_{\mathrm{exact}}$  分别是状态  $\rho$  在有误差和无误差条件下的可观测量  $\hat{O}$  的期望值。

该方法包括以下步骤：

1. 选择近 Clifford 电路进行训练：选择近 Clifford 电路是因为它们可以高效地进行经典模拟，这些线路的集合表示为  $\{C_i\}$ 。

2. 构建训练集：通过在量子计算机上计算每个状态  $\rho_i \in \{\mathcal{C}_i\}$  的期望值  $\mathbf{y}_{\mathrm{err}}(\rho_i)$  和在经典计算机上计算  $\mathbf{y}_{\mathrm{exact}}(\rho_i)$  来构建训练集  $\{\{\mathbf{y}_{\mathrm{err}}(\rho_i), \mathbf{y}_{\mathrm{exact}}(\rho_i)\} \}$ 。

3. 学习误差缓解模型：定义并学习模型  $\hat{\mathcal{M}}$ ，该模型是  $\mathbf{y}_{\mathrm{err}}$  的参数化函数  $\hat{\mathcal{M}} (\mathbf{y}_{\mathrm{err}}, \vec{\theta})$ ，其中  $\vec{\theta}$  是要确定的参数集合。通过最小化训练集上的距离来实现参数  $\vec{\theta}$  的学习，优化问题表达式为：

$$
\vec{\theta} = \arg \min_{\vec{\theta}} \sum_i \left\| \hat{\mathcal{M}} (\mathbf{y}_{\mathrm{err}}(\rho_i), \vec{\theta}) - \mathbf{y}_{\mathrm{exact}}(\rho_i) \right\| ^2
$$

4. 应用误差缓解模型：使用学习到的模型  $\hat{\mathcal{M}}$  来校正新量子态  $\rho$  的期望值  $\mathbf{y}_{\mathrm{err}}(\rho)$ ，表示为：

$$
\mathbf{y}_{\mathrm{mitigated}}(\rho) = \hat{\mathcal{M}} (\mathbf{y}_{\mathrm{err}}(\rho), \vec{\theta})
$$

需要注意的是，Clifford 线路 Pauli 串的测量值只有  $\pm 1,0$  三种取值，在第二步中我们需要专门挑选出期望不为零的线路，否则噪声的影响无法被准确学习到（因为期望是 0 的线路加了噪声期望大概率也还是 0）。该误差缓解方案基于 QREM 和 CDR[?]，适用于含噪  $CZ'$  门的变分优化法，且为三个误差缓解方案中唯一一个可以用于含噪  $CZ'$  门的变分优化法的方案。（如果再加上 PT 也可以用于其他两种演化方案）具体方案可以被概括如下：

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/d8ac3c280b7245a08bbc4bbfd51a26f741f21ff4f0c0b28fc92e396dcab32d27.jpg)  
图7 进行含时演化的变分量子线路。包含6个变分层和6个纠缠层。图中的单比特门参数为变分优化之后的参数，这些参数在训练之前被初始化为0。两比特门在无噪声训练时为标定的  $CZ'$  门，在带噪模拟器上运行时视作  $CZ$  门。

1. 按照3.2.1的方法标定读取误差。

2. 运行含时演化线路并测量，并进行读取矫正。

3. 固定图7的线路结构，随机其中的单比特门参数，构建一系列相同结构的随机近 Clifford 线路，并将这些线路分别在含噪模拟器和理想模拟器上运行，得到相应的含噪值和理想值。

4. 选用线性拟合函数对带噪观测值-理想观测值进行拟合。

5. 将测量结果带入拟合的线性函数得到误差缓解结果。

步骤1和2的详细过程参照3.2.1。

步骤3的核心在于构建用于函数拟合的数据集。这里我们设置Clifford门的比例为0.9以保证该方法的可拓展性。该方法的核心在于近Clifford线路可以在经典上高效仿真。我们首先进行随机近Clifford线路的采样，且在采样后进行筛选，针对每个 $\langle Z_{i}\rangle ,\langle Y_{i}\rangle ,i\in \{0,1,2,3,4,5\}$  ，保留那些理想观测结果与目标演化线路的带噪观测结果相近的近Clifford线路，随后将这些线路运行在含噪量子模拟器和无噪声模拟器上，以得到一系列  $\{O_{\mathrm{noisy}},O_{\mathrm{ideal}}\}$  的数据对。

步骤4则首先选择线性拟合函数

$$
\hat{O}_{\mathrm{ideal}} = \alpha_{1}O_{\mathrm{noisy}} + \beta_{1}, \tag{20}
$$

随后针对每个  $\langle Z_{i}\rangle ,\langle Y_{i}\rangle ,i\in \{0,1,2,3,4,5\}$  拟合上述函数。

步骤5则将步骤2中得到的含噪观测结果带入步骤4中拟合得到的函数中得到一系列误差缓解值  $\langle \hat{Z}_{i}\rangle ,\langle \hat{Y}_{i}\rangle ,i\in \{0,1,2,3,4,5\}$  ，最后参照式18计算平均值得到最终的误差缓解结果。

# 3.3.4CZ相位补偿

量子门错误指的是我们认为我们执行了一个量子门，但实际上执行上有一定偏差。理想的CZ门为：

$$
C Z=\left[\begin{array}{l l l l}{1}&{0}&{0}&{0}\\ {0}&{1}&{0}&{0}\\ {0}&{0}&{1}&{0}\\ {0}&{0}&{0}&{-1}\end{array}\right]
$$

然而通过分析我们发现，实际执行的量子门为：

$$
C Z^{\prime}\equiv [R Z(a)\otimes R Z(b)]\cdot {\left[\begin{array}{l l l l}{1}&{0}&{0}&{0}\\ {0}&{\cos t}&{0}&{i e^{i\chi}\sin t}\\ {0}&{-i e^{-i\chi}\sin t}&{\cos t}&{0}\\ {0}&{0}&{0}&{e^{i(\pi+\delta)}}\end{array}\right]}
$$

其中  $t$  为iSWAP角度，  $\chi$  是iSWAP相位，  $\delta$  是受控相位误差，  $a$  和  $b$  则是作用在第一个和第二个比特上的单比特残余相位。在理想情况下，  $t = \chi = \delta = a = b = 0$  ，但事实上这些值不一定为0，反而存在绝对值较小的值。

由于在含噪模拟器上实际执行的  $CZ'$  门具有式 ??所描述的形式，为了减少  $CZ'$  门的误差，我们首先使用如下线路对两个单比特 RZ 相位进行补偿。通过这种方式可以矫正掉含噪  $CZ'$  门的单比特 Z 相位误差。

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/a461301226ad209b5c6ddfa076d7435d6661fa5d608351163e0578bb06434b2a.jpg)  
图8 对  $CZ'$  门进行单比特相位补偿线路。

# 3.3.5 泡利旋转（Pauli Twirling）

泡利旋转（Pauli Twirling，PT）是一种量子噪声调整技术，旨在将噪声通道转化为更易处理的随机Pauli通道。通过对量子系统随机应用一系列Pauli门操作，然后对结果进行平均，可以减少误差的复杂性。PT可以成为量子系统噪声管理的有力工具。通过在Pauli门上进行旋转，PT将复杂的噪声通道转化为更简单的随机Pauli噪声通道。比如  $T_{1}$  引起的热弛豫噪声原本只能通过Kraus Operator表示，若施加PT便能将其改造成Pali噪声通道。PT的成功取决于各种因素，例如噪声的性质和量子系统的具体特性。值得注意的是，虽然PT通常简化了噪声通道，但在某些情况下，它可能会将噪声转化为负面影响，例如完全去极化通道，从而导致量子信息的完全丢失。

为了获得最佳结果，实施Pauli旋转时应了解底层噪声动态，理想情况下，应与更直接的误差缓解技术结合使用，以确保稳健的量子计算。在量子误差缓解的背景下，PT更接近于动态解耦，但作为一种噪声调整技术，具有独特性。由于带噪模拟器中的  $CZ'$  门的误差为相干误差，在实际实验中，相干误差非常影响误差缓解方法的有效性，因此，需要将  $CZ'$  门的相干误差转化为泡利误差，这一过程通过PT来实现。

对于一个一般的  $n$  量子比特的噪声通道  $\Lambda$  ，一般的旋转（Twirl）方法首先对原量子态施加  $n$  比特随机操作  $A$  ，然后作用噪声通道  $\Lambda$  ，最后再次施加先前随机选择的操作的逆  $A^{- 1}$  ，对这一过程在  $M$  个不同的操作集合  $\mathcal{A} = \{A_i\}_{i = 1}^M$  上多次随机取平均，可以得到一个新的噪声通道

$$
\Lambda_{A}(\rho) = \mathbb{E}_{A\in \mathcal{A}}A^{-1}\Lambda (A\rho A^{-1})A. \tag{21}
$$

其中  $\rho$  是初始  $n$  比特量子态，当  $\mathcal{A} = \mathcal{P} = \{I,X,Y,Z\}^{\otimes n}$  为  $n$  比特泡利基时，上述噪声通道  $\Lambda_{A}$  可以被转换为泡利噪声通道

$$
\Lambda_{P}(\rho) = \mathbb{E}_{P\in \mathcal{P}}c_{P}P\rho P, \tag{22}
$$

其中  $c_{P}$  是泡利通道系数。上述过程的严格证明由文献[？]给出，在此不在赘述。

然而，量子噪声通道会伴随着量子门一起出现，量子通道本身不会单独出现。由于模拟器中单比特门被视作理想门，因此泡利旋转操作只需要针对  $CZ'$  门进行。对于带噪的  $CZ'$  门，其可以表示为

$$
C Z^{\prime} = \Lambda \circ C Z, \tag{23}
$$

其中  $\Lambda$  是  $CZ'$  门真实的相干噪声通道，为了对  $\Lambda$  进行泡利旋转，我们需要根据泡利门和  $CZ$  门的对易关系将这个过程转换为在带噪声的  $CZ'$  门前后插入相应的单比特泡利门来实现

$$
\begin{array}{c}\Lambda_P \circ CZ = \mathbb{E}_{P \in \mathcal{P}} P \Lambda \circ CZ P' \\ = \mathbb{E}_{P \in \mathcal{P}} P \Lambda \circ PCZ \end{array} \tag{25}
$$

其中  $CZ P = P' CZ$ ， $\mathcal{P} = \{I, X, Y, Z\}^{\otimes 2}$ 。所有的泡利门与  $CZ$  门的对易关系如下：

$$
\begin{array}{rl} & X \otimes I \leftrightarrow X \otimes Z, \quad I \otimes X \leftrightarrow Z \otimes X, \\ & Y \otimes I \leftrightarrow Y \otimes Z, \quad I \otimes Y \leftrightarrow Z \otimes Y, \\ & X \otimes Y \leftrightarrow Y \otimes X, \quad X \otimes X \leftrightarrow Y \otimes Y, \\ & I \otimes I \otimes , \quad Z \otimes Z \otimes , \quad Z \otimes I \otimes , \quad I \otimes Z \otimes . \end{array}
$$

- Note：本题中只有热弛豫噪声这一项需要通过 PT 转化为 Pauli 噪声通道。其余噪声例如退极化 (depolarizing) 噪声、 $T_2$  导致的退相位 (dephasing) 噪声都天然就可以写为 Pauli 噪声通道的形式。

表1 消融实验。  

<table><tr><td></td><td>&lt;z&gt;</td><td>&lt;y&gt;</td></tr><tr><td>-QREM</td><td>0.5344 ± 0.0031</td><td>-0.5678 ± 0.0030</td></tr><tr><td>-PT</td><td>0.5965 ± 0.0014</td><td>-1.5365 ± 0.0044</td></tr><tr><td>-CZ 相位补偿</td><td>0.5587 ± 0.0028</td><td>-0.7960 ± 0.0166</td></tr><tr><td>-ZNE</td><td>0.4818 ± 0.0028</td><td>-0.6832 ± 0.0020</td></tr></table>


</z></y></z>

# 四、总结及展望

# 4.1 实验结果

我们为了更清楚直观表明误差环节方法的效果，使用了一个 6 比特的 Ising 量子电路进行测试分析。我们的实验中固定了每个噪声尺度下 PT 线路的数量乘以单个线路的

shots 恒定为 100,000，但无论在实际模拟还是真机运行时，线路的数量均与运行时长存在一定的关系，线路数量越多，运行时长会越长。下面是我们的一系列测试结果：记

$$
\begin{array}{l}\langle Z\rangle = \left\langle \psi (t)\left|\frac{1}{N}\sum_{i = 1}^{N}Z_{i}\right|\psi (t)\right\rangle ,\\ \langle Y\rangle = \left\langle \psi (t)\left|\frac{1}{N}\sum_{i = 1}^{N}Y_{i}\right|\psi (t)\right\rangle . \end{array} \tag{26}
$$

经过错误缓解运行后，我得到的期望值：  $\langle Z\rangle = 0.5497,\langle Y\rangle = - 0.8109$  （总采样次数为2,000,000,PauliTwirling数为400，ZNEscale数量为9. 模拟时间2小时），  $\langle Z\rangle = 0.5527$ $\langle Y\rangle = - 0.8096$  （总采样次数为200,000,PauliTwirling数为150，ZNE scale数量为7. 模拟时间20分钟)，理论期望值为：  $\langle Z\rangle = 0.5493$  ，  $\langle Y\rangle = - 0.8094$  。实验中我们进行了多种不同的方案，这些方案各有优劣，在此我们汇报了在题目给定条件下的最优解。表2汇总了这些不同方案的实验结果。

表2 误差缓解结果汇总表。  

<table><tr><td>实验方案</td><td>平均〈Z〉</td><td>最优〈Z〉</td><td>平均〈Y〉</td><td>最优〈Y〉</td><td>总采样次数</td></tr><tr><td>理想CZ变分优化&amp;amp;ZNE（高精度）</td><td>0.5487±0.0026</td><td>0.5497</td><td>-0.8127±0.0028</td><td>-0.8109</td><td>2,000,000</td></tr><tr><td>理想CZ变分优化&amp;amp;ZNE（高性价比）</td><td>0.5522±0.0085</td><td>0.5527</td><td>-0.8113±0.0078</td><td>-0.8096</td><td>200,000</td></tr><tr><td>Trotter&amp;amp;ZNE</td><td>0.5528±0.0276</td><td>0.5463</td><td>-0.8138±0.0182</td><td>-0.8003</td><td>2,000,000</td></tr><tr><td>含噪CZ变分优化&amp;amp;CDR</td><td>0.5557±0.0032</td><td>0.5537</td><td>-0.7825±0.0059</td><td>-0.7884</td><td>2,000,000</td></tr><tr><td>含噪CZ变分优化&amp;amp;PEC</td><td>0.5431±0.0044</td><td>0.5489</td><td>-0.8043±0.0074</td><td>0.8089</td><td>310,000</td></tr></table>

我们额外考察了PT线路数量和最终精度的关系，结果如图4.1中所示。

![](https://cdn-mineru.openxlab.org.cn/result/2025-08-07/f9167c3e-586d-42db-9f41-c390f7c05156/f4b24679fdbf2ffbddbc872a36e23d3eec976fab93f730c8514c5085113c5bff.jpg)  
图9 每个噪声尺度下PT线路数量和实验结果的关系图。阴影区域表示10次实验的一个标准差的误差范围。

为了证明 QREM、 $CZ$  相位矫正、PT、ZNE 的有效性，我们额外进行了相关的消融实验，结果显示，在不进行读取矫正和 PT 的情况下，会产生巨大不切实际的偏差，基本无法正确推断出理想的观测结果，如果不做 ZNE，则实验效果会出现显著的下降，而如果不做  $CZ$  相位补偿，则会由于  $CZ$  噪声的增加使得误差缓解效果出现一定的下降，实验结果如表1所示。

# 4.2 实验总结

本部分我们对三种误差缓解方案进行详细分析。

ZNE 通过额外对多个处于不同噪声水平的量子线路进行测量，并通过外推函数进行外推拟合得到观测量的理想估计值，适用于各种不同的量子线路。ZNE 的采样成本随着噪声尺度数量的呈增加线性增长。作为一种外推方法，ZNE 缺乏理论收敛保证，其性能非常依赖于噪声种类和选择的拟合函数，通过使用 PT 将相干噪声转化为非相干噪声，ZNE 的效果可以得到显著的提升。线性拟合和指数拟合是两种最为常用的拟合函数，在采样次数和噪声尺度足够的情况下，指数拟合呈现出更优的性能，同时对比 Trotter 线路和理想  $CZ$  线路，可以发现线性拟合和指数拟合的差距会随着初始线路的噪声的增加而增加。ZNE 适合于观测量数量较少、测量结果准确性要求较高的测控场景。

CDR 则通过生成随机数据集，学习特定结构量子线路带噪观测结果和理想观测结果的函数关系来进行误差缓解。CDR 额外的采样成本在于随机训练数据集的构建，其采样成本随着量子线路结构的增加而增加，与 ZNE 类似，作为一种学习算法，CDR 同样缺少理论的收敛保证，其性能较为依赖随机数据集的构建，同时线性拟合函数只能捕捉到大致的噪声关系，缓解后的精确度有限，但因为 CDR 使用较为简单的拟合函数，因此其所需要的采样成本相对较小，同时其采样成本与量子线路结构有关，因此 CDR 适合于类似变分量子线路的训练等需要多次重复运行相同结构的量子线路的测控场景。

从可拓展性来说，ZNE 和 CDR 均具有较好的拓展性，但基于线路折叠的 ZNE 方法仅适用于  $CZ$  或者  $CNOT$  这种逆变换等于自身的两比特门，同时 PT 仅适用于和泡利算符有较好对易关系的两比特门，因此如果将题目中的两比特门的理想形式视作  $CZ'$ （含噪  $CZ'$  门的变分优化法），则 ZNE 无法使用。而 CDR 则对两比特门的具体形式没有要求，因此含噪  $CZ'$  门的变分优化法可以使用 CDR 进行误差缓解。

最后，由于本题噪声模型比较简单，也比较适合用 PEC 方法进行矫正。我们只考虑了显著误差集，只需从线路的测量结果就可以计算出校正后的期望。这样做非常依赖于对噪声模型的精确把握，所以并不很通用。但是如果能建立类似 IBM 那种稀疏 Pauli- Lindblad 噪声模型，PEC 是个不错的选择。

#

[1] NACHMAN B, URBANEK M, DE JONG W A, et al. Unfolding quantum computer readout noise[J]. npj Quantum Information, 2020, 6(1):84. [2] POKHAREL B, SRINIVASAN S, QUIROZ G, et al. Scalable measurement error mitigation via iterative bayesian unfolding[J]. Physical Review Research, 2024, 6(1):013187. [3] NATION P D, KANG H, SUNDARESAN N, et al. Scalable mitigation of measurement errors on quantum computers[J]. PRX Quantum, 2021, 2(4):040326. [4] TAN S, LU L, ZHANG H, et al. Qufem: Fast and accurate quantum readout calibration using the finite element method[C]//Proceedings of the 29th ACM International Conference on Architectural Support for Programming Languages and Operating Systems, Volume 2. [S.l.: s.n.], 2024: 948- 963. [5] GIURGICA- TIRON T, HINDY Y, LAROSE R, et al. Digital zero noise extrapolation for quantum error mitigation[C]//2020 IEEE International Conference on Quantum Computing and Engineering (QCE). [S.l.]: IEEE, 2020: 306- 316. [6] LOWE A, GORDON M H, CZARNIK P, et al. Unified approach to data- driven quantum error mitigation[J]. Physical Review Research, 2021, 3(3):033098. [7] CZARNIK P, ARRASMITH A, COLES P J, et al. Error mitigation with Clifford quantum- circuit data[J/OL]. Quantum, 2021, 5:592. https://doi.org/10.22331/q- 2021- 11- 26- 592. [8] GUPTA R S, VAN DEN BERG E, TAKITA M, et al. Probabilistic error cancellation for dynamic quantum circuits[J]. Physical Review A, 2024, 109(6):082617. [9] LI Y, BENJAMIN S C. Efficient variational quantum simulator incorporating active error minimization[J/OL]. Phys. Rev. X, 2017, 7.021050. https://link.aps.org/doi/10.1103/PhysRevX.7.021050. [10] TEMME K, BRAVYI S, GAMBETTA J M. Error mitigation for short- depth quantum circuits[J/OL]. Phys. Rev. Lett., 2017, 119:180509. https://link.aps.org/doi/10.1103/PhysRevLett.119.180509.

[11] ZHANG S, LU Y, ZHANG K, et al. Error- mitigated quantum gates exceeding physical fidelities in a trapped- ion system[J/OL]. Nature Communications, 2020, 11(1):587. https://doi.org/10.1038/s41467- 020- 14376- z.

[12] GELLER M R, ZHOU Z. Efficient error models for fault- tolerant architectures and the pauli twirling approximation[J]. Physical Review A—Atomic, Molecular, and Optical Physics, 2013, 88(1):012314.

[13] KANDALA A, TEMME K, CÓRCOLES A D, et al. Error mitigation extends the computational reach of a noisy quantum processor[J/OL]. Nature, 2019, 567(7749):491- 495. https://doi.org/10.1038/s41586- 019- 1040- 7.

[14] GIURGICA- TIRON T, HINDY Y, LAROSE R, et al. Digital zero noise extrapolation for quantum error mitigation[C/OL]//2020 IEEE International Conference on Quantum Computing and Engineering (QCE). 2020: 306- 316. DOI: 10.1109/QCE49297.2020.00045.

[15] NIELSEN M A, CHUANG I L. Quantum computation and quantum information: volume 2[M]. [S.1. ]: Cambridge university press Cambridge, 2001.

[16] PERUZZO A, MCCLEAN J, SHADBOLT P, et al. A variational eigenvalue solver on a photonic quantum processor[J/OL]. Nature Communications, 2014, 5(1):4213. https://doi.org/10.1038/ncomms5213.

[17] GRIMSLEY H R, ECONOMOU S E, BARNES E, et al. An adaptive variational algorithm for exact molecular simulations on a quantum computer[J/OL]. Nature Communications, 2019, 10(1):3007. https://doi.org/10.1038/s41467- 019- 10988- 2.

[18] TANG H L, SHKOLNIKOV V, BARRON G S, et al. Qubit- adapt- vqe: An adaptive algorithm for constructing hardware- efficient ansätze on a quantum processor[J/OL]. PRX Quantum, 2021, 2:020310. https://link.aps.org/doi/10.1103/PRXQuantum.2.020310.

[19] QUANTUM G A, COLLABORATORS*, ARUTE F, et al. Hartree- fock on a superconducting qubit quantum computer[J/OL]. Science, 2020, 369(6507):1084- 1089. https://www.science.org/doi/abs/10.1126/science.abb9811.

[20] LOWE A, GORDON M H, CZARNIK P, et al. Unified approach to data- driven quantum error mitigation[J/OL]. Phys. Rev. Res., 2021, 3:033098. https://link.aps.org/doi/10.1103/PhysRevResearch.3.033098.

[21] O'BRIEN T E, ANSELMETTI G, GKRITSIS F, et al. Purification- based quantum error mitigation of pair- correlated electron simulations[J/OL]. Nature Physics, 2023, 19(12): 1787- 1792. https://doi.org/10.1038/s41567- 023- 02240- y.