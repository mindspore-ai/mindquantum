# 量子启发算法及其在阵列天线波束赋形中的应用

王梓沣、何宗沅、大连理工大学信息与通信工程学院

指导教师：李慧教授

# 摘要

本文在量子启发算法的基础上进行改进，通过组合优化天线阵列中天线阵子的振幅和相位实现波束赋形。改进的量子启发算法针对传统量子启发算法面临的问题，提出了采用精英选择、设置量子比特概率振幅阈值和取消“迁移策略”等改进点，并优化了量子启发算法流程。改进后的量子启发算法能够增大全局搜索和跳出局部最优的能力，并保持种群的多样性，实现了在有限时间内组合优化的条件下，能够相对稳定地得到问题足够好的近似解。然后本文进行大量对比实验探究了不同目标优化角度、不同相位量化比特数条件下赋形结果的变化趋势及原理。并根据实验结果分析了算法存在的问题，提出了一种使用非支配排序方法求解多目标问题的量子启发算法——非支配排序量子启发算法。

# 1 问题背景与描述

# 1.1 问题与算法背景

在当今无线通信技术飞速发展的时代，高速率、大容量、广覆盖以及高可靠性成为通信领域追求的核心目标。天线作为无线通信系统中实现电磁波发射与接收的关键部件，其性能的优劣直接决定了整个通信系统的质量。而天线阵子波束赋形技术，作为提升天线性能、优化无线通信质量的关键手段，正逐渐成为研究热点。

阵列天线是由多个天线阵子（Antenna Elements）按照特定几何结构排列组成的系统，通过协同工作实现电磁波的定向发射或接收。每个阵子独立辐射或接收信号，但通过调整阵子的激励（振幅、相位）和空间布局，阵列可形成具有特定方向性、增益和波束控制能力的辐射或接收模式。由于实际问题中天线阵子通常数量较多，要实现特定方向波束赋形，就需要解决整体天线阵子相位和振幅的组合优化问题。针对这一类组合优化问题，传统算法如梯度下降法、线性规划、牛顿法等可能具有很大的时间复杂度或者空间复杂度，难以在一定时间内找到有效的优化结果。为了解决这类比较复杂的优化问题，学术界提出了一系列具备更强适应性、鲁棒性和搜索能力的新型算法，这便是智能优化算法。

智能优化算法（Intelligent Optimization Algorithm）是一类受自然界现象或生物行为启发，通过模拟自然界的规律或生物的智能行为，来求解复杂优化问题的最优解或者近似最优解。如今的智能优化算法，包括遗传算法（Genetic Algorithm，GA）、粒子群优化（Particle Swarm Optimization，PSO）、差分进化（Differential Evolution，DE）和蚁群优化（Ant Colony Optimization，ACO）等，已经发展成熟并应用到了天线优化设计领域[1-4]，相比传统算法有着显著的成效。此外，量子启发式算法正在兴起，表现出比传统智能优化算法更优越的性能，文献[5]提出的一种量子启发进化算法（Quantum-Inspired Evolutionary Algorithm，QEA），以解决背包优化问题为例，展现了量子启发算法的显著效用。文献[5]中的研究结果表明，与传统遗传算法相比，QEA即使在较小的种群规模下也能表现良好，并能够有效避免过早收敛。

在本文中，以阵列天线为主要研究目标，研究各个天线阵子的相位和幅度组合优化，实现特定角度上波束赋形的目标。论文参考了量子启发算法相关文献，以量子启发算法为基础，探究阵列天线波束赋形的组合优化问题。

# 1.2 问题描述

阵列天线阵子的排布建模如图1.1（a）所示，模型中采用的是等间距半波长线性排列的天线阵子（用黑色直线表示，忽略天线阵子的具体结构）组成的天线阵列，所有的 $N$ 个天线阵子都在z轴上，极坐标系和直角坐标系间的转换关系也在图中绘出，其中， $\theta$ 为方向向量与z轴的夹角， $\phi$ 为方向向量投影在xy平面后与x轴的夹角， $\theta \in [0,\pi ]$ ， $\phi \in [0,2\pi)$ 。假定有 $N$ 个天线阵子组成图1.1所示的线阵，取 $\phi = 90^{\circ}$ ，以 $|F(\theta)|^{2}$ 度量天线阵列在 $(\theta ,\phi)$ 方向的信号强度， $|F(\theta)|^{2}$ 关于 $\theta$ 的计算公式可以表述如下：

$$
\left|F(\theta)\right|^2 = E(\theta)\left[\sum_{n = 1}^{N}A_n(\theta)\right]\left[\sum_{n = 1}^{N}A_n^* (\theta)\right] \tag{1.1}
$$

其中，

$$
A_{n}(\theta) = \left[\beta_{n}\exp (i\alpha_{n})\right]\exp (\pi in\cos \theta) = \beta_{n}\exp (i(\alpha_{n} + \pi n\cos \theta)) \tag{1.2}
$$

$$
E(\theta) = 10^{\frac{E_{AB}(\theta)}{10}} \tag{1.3}
$$

$$
E_{dB}(\theta) = -\min \left\{12\left(\frac{\theta - 90^{\circ}}{90^{\circ}}\right)^{2},30\right\} \tag{1.4}
$$

![](https://i.ibb.co/99z0vPQw/1s1.png)

图1.1 （a）天线阵列建模示意图 （b）波束赋形目标示意图

其中，  $\theta \in [0^{\circ},180^{\circ}]$  ，  $\theta_{0}$  为主瓣目标方向，  $\alpha_{n}$  是第  $n$  个阵子的相位角（可在  $[0,2\pi)$  范围内按照  $b_{1}$  比特离散调节），  $\beta_{n}$  是第  $n$  个阵子的振幅（可在  $[0,1]$  的范围内连续变化/不做优化）。

波束赋形目标示意图如图1.1（b）所示，赛题要求参赛选手基于量子启发算法（或将量子启发算法与其他优化方法结合），构建算法以自动搜寻在主瓣方向  $\theta_{0}\in [45^{\circ},135^{\circ}]$  的连续范围内最优的相位-振幅序列  $\{\alpha_{n},\beta_{n}\}$  ，使  $N = 32$  的天线阵列同时满足如下场景的需求：

a．压制成型方向  $\left[\theta_{0} - 30^{\circ},\theta_{0} + 30^{\circ}\right]$  内旁瓣强度  $\left|F(\theta)\right|^2$  ，使其强度至少低于主瓣强度 $\left|F(\theta)\right|^2$  的-30dB。

b.在  $0^{\circ}\leq \theta \leq \theta_{0} - 30^{\circ}$  和  $\theta_{0} + 30^{\circ}\leq \theta \leq 180^{\circ}$  的范围内旁瓣强度  $\left|F(\theta)\right|^2$  低于主瓣强度 $\left|F(\theta)\right|^2$  的-15dB。

c．减小主瓣的宽度  $W$  ，最好能达到  $8^{\circ}$  。

d．主瓣方向（使得  $\left|F(\theta)\right|^2$  取得最大值的  $\theta$ ）与目标波束赋形方向  $\theta_{0}$  相差不超过  $1^{\circ}$  。

# 2 问题分析

# 2.1 研究现状

近年来，量子启发算法因其在处理复杂优化问题中的并行搜索能力和出色的全局探索性能，受到越来越多研究者的关注。量子启发进化算法[5]最早由Kuk-Hyun Han和Jong-Hwan Kim于2002年提出。量子启发进化算法结合量子计算与传统进化算法，利用量子叠加态现象进行全局搜索，以高效率寻找最优解。文献中的研究结果表明，与传统遗传算法相比，QEA即使在较小的种群规模下也能表现良好，并能够有效避免过早收敛。

Sangbin Lee等人于2024年提出了量子退火算法[6]（Quantum Annealing Algorithm），表明量子退火在电磁优化问题中展现出显著优势：其利用量子隧穿效应有效规避局部最优解，在非凸问题（如  $45^{\circ}$  波束赋形）中实现全局优化；天然适配离散组合问题（如RIS相位配置），通过domain-wall编码节省  $25\%$  量子比特资源；处理大规模问题时性能卓越，实验证明在6400单元超表面优化中比模拟退火快37.9倍。应用层面成功实现RIS波束精准定向（旁瓣抑制达-30dB）、天线电流分布求解（误差  $\leq 5\%$  ）及生物电磁聚焦（精度  $>99.85\%$  ），并通过量子-经典混合架构突破硬件限制，为实时电磁优化提供新范式。

Fengling Peng等人于2024年提出了一种量子启发式算法[7]（Quantum-Inspired Algorithm，QIA），用于高效优化超宽带天线。此文将量子计算中的纠缠态引入天线优化，促进了对天线优化设计解决方案的高效探索。此文提出了一种方法，在单个天线设计方案中创建不同天线设计变量之间的内部纠缠态，使得算法能够在探索广阔的解空间时有效避免不太有前途的区域，从而使搜索更加有针对性；除此之外又介绍了一种方法，即在多个天线设计方案之间创建外部纠缠态，使得算法能够并行处理多个设计方案的演化。借助量子纠缠态，这些方法使得天线设计方案的探索与开发更加平衡，从而提高了天线优化的速度。

# 2.2 与本文工作的关联

阵列天线通过优化天线阵子的振幅和相位实现波束赋形，是一类典型的组合优化问题，组合优化问题的研究历史悠久，提出了许多高效可行的算法，其中，量子启发算法通过模拟量子世界的物理变化规律，依靠量子的特殊物理特性解决组合优化问题，效果显著。

文献[5]中，Kuk-Hyun Han和Jong-Hwan Kim提出了量子启发算法，并以解决背包问题为例测试了算法性能。该算法构建一个量子比特种群，种群中的每个个体由一组量子比特表示。首先初始化量子比特种群中每个量子比特的概率振幅，并观测得到经典比特种群作为初代种群。在种群迭代过程中，首先对量子比特种群进行观测，使量子比特由叠加态坍缩为确定态，比较新生种群和上一代种群的适应度，通过量子旋转门对量子比特进行坍缩概率调整，选择出两代种群中的精英个体，并迁移到种群其他个体上，使其他个体均向精英个体的方向进化。迁移过程分为局部迁移（保留一部分原始种群）和全局迁移（将种群中所有个体都替换为最优个体），迁移增强了精英个体的优势地位。

Kuk-Hyun Han和Jong-Hwan Kim提出的QEA十分高效地解决了经典背包问题，与本赛题中的天线阵子组合优化问题有着一定的相似度。因此本文在基于文献[5]中的QEA，提出了一种改进的QEA，使其更加适应赛题背景，本文做出的改进主要包括：设定量子比特概率振幅的旋转阈值、取消了迁移策略、采取精英选择策略。通过三个方面的改进，使得算法更加适合解决天线阵子的组合优化问题。

# 3 方案描述

# 3.1 量子计算基本知识

# 3.1.1 量子比特

量子计算中最基本的单位是量子比特（Q-bit）。量子比特是一种特殊的比特，与传统计算机的经典比特不同，传统计算机的经典比特的状态只有确定的“0”和“1”两种状态，而量子比特的状态则是一个处于“0”状态和“1”状态叠加的状态，称为叠加态。在观测量子比特时，量子比特会坍缩为“0”和“1”状态中的某一个。因此，一个量子比特的状态可以表示为：

$$
\left|\psi \right\rangle = \alpha \left|0\right\rangle +\beta \left|1\right\rangle \tag{3.1}
$$

或者更为简洁地表示为：

$$
\left[ \begin{array}{c}\alpha \\ \beta \end{array} \right] \tag{3.2}
$$

其中， $\alpha$  和  $\beta$  分别是“0”状态和“1”状态的概率振幅，在观测该量子比特期间，量子比特坍缩为“0”状态的概率为  $\left|\alpha \right|^2$ ，坍缩为“1”状态的概率为  $\left|\beta \right|^2$ ，由概率的性质可以得到两个振幅满足的关系式是：

$$
\left|\alpha \right|^2 +\left|\beta \right|^2 = 1 \tag{3.3}
$$

![](https://i.ibb.co/LdFg4xsy/3s1.jpg)
图3.1 量子比特的极坐标表示

可以用极坐标图更形象地展示量子比特的状态，如图3.1所示，一个量子比特可以表示为极坐标单位圆上的一个点，对应到笛卡尔坐标系的横坐标和纵坐标分别是  $\alpha$  和  $\beta$ 。

在QEA中，若干个量子比特构成一个基因片段，若干个基因片段构成一条染色体，而若干条染色体构成一个量子比特个体。在本文中，假设一个量子比特个体由一条染色体组成。

一个由  $m$  个量子比特组成的量子比特个体，通常表示为：

$$
\begin{bmatrix} \alpha_{1} & \alpha_{2} & \dots & \alpha_{m} \\ \beta_{1} & \beta_{2} & \dots & \beta_{m} \end{bmatrix} \tag{3.4}
$$

在QEA中，由若干个量子比特个体构成一个量子比特种群，一个由  $n$  个量子比特个体构成的量子比特种群，可以表示为：

$$
\left\{\left[\alpha_{11}\left|\alpha_{12}\right|\dots \left|\alpha_{1m}\right.\right];\left[\alpha_{21}\left|\alpha_{22}\right|\dots \left|\alpha_{2m}\right.\right];\dots;\left[\alpha_{n1}\left|\alpha_{n2}\right|\dots \left|\alpha_{nm}\right.\right]\right\} \tag{3.5}
$$

在本论文中，一个量子比特个体有一条染色体，包含振幅和相位两个基因片段，每个基因片段由一组量子比特表示。

# 3.1.2 量子门

由于QEA中仅使用到Hadamard门和旋转门，因此重点对这两种门进行介绍。

Hadamard门（哈达玛门，简称H门）是量子计算中的基本单量子比特逻辑门，主要功能是将一个量子比特从基态（0或1）转换为叠加态，作为通用量子门集的组成部分，可支持任何量子算法的运行。Hadamard门用于QEA算法的初始化部分，其矩阵可以表示为：

$$
\mathbf{H} = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 & 1 \\ 1 & -1 \end{bmatrix} \tag{3.6}
$$

当Hadamard门作用于基态  $|0\rangle$  时，  $H|0\rangle = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 & 1 \\ 1 & - 1 \end{bmatrix} \begin{bmatrix} 1 \\ 0 \end{bmatrix} = \begin{bmatrix} 1 / \sqrt{2} & 1 / \sqrt{2} \\ 1 / \sqrt{2} & 1 / \sqrt{2} \end{bmatrix}$ ，可以利用此特性对QEA初始化。

量子旋转门是QEA中的核心算子，主要用于更新量子个体，实现种群的进化。它通过改变量子比特的角度，影响量子比特的概率振幅，即调节量子比特坍缩为“0”状态和“1”状态的概率。

量子旋转门通常表示为一个  $2\times 2$  的酉矩阵，其一般形式为：

$$
G(\Delta \theta) = \left[ \begin{array}{cc}\cos (\Delta \theta) & -\sin (\Delta \theta)\\ \sin (\Delta \theta) & \cos (\Delta \theta) \end{array} \right] \tag{3.7}
$$

![](https://i.ibb.co/mrnmhsd5/3s2.jpg)
图3.2 极坐标系中的量子旋转门表示

如图3.2所示，量子旋转门作用于单量子比特时，会使该量子比特旋转  $\Delta \theta$  角度。假设一个量子比特用  $[\alpha ,\beta ]^{\mathrm{T}}$  表示，经过量子旋转门作用后，新的量子比特状态为：

$$
\begin{array}{r}\left[ \begin{array}{c}\alpha \\ \beta \end{array} \right] = \left[ \begin{array}{cc}\cos (\Delta \theta) & -\sin (\Delta \theta)\\ \sin (\Delta \theta) & \cos (\Delta \theta) \end{array} \right]\left[ \begin{array}{c}\alpha \\ \beta \end{array} \right] \end{array} \tag{3.8}
$$

这个过程称之为量子比特更新。

# 3.2 QEA算法流程

# 3.2.1 QEA的基本参数和概念

后续小节中涉及的QEA算法一些术语和概念，本小节一并解释如下：

天线阵子的相位基因段：用若干个量子比特表示一个天线阵子的相位，与实际相位数值之间存在映射关系。

天线阵子的幅度基因段：用若干个量子比特表示一个天线阵子的幅度，与实际幅度数值之间存在映射关系。

天线阵子的基因组：一个天线阵子中相位基因段和幅度基因段的组合。

量子比特个体：一个个体由若干个天线阵子基因组构成。

量子比特种群：一个种群由若干个量子比特个体构成。适应度向量：种群中由所有个体的适应度值构成的向量。新生种群：观察量子比特种群后坍缩生成的经典比特种群。精英种群：精英选择后的得到的经典比特种群。QEA算法涉及的一些主要参数如表3.1所示：

表3.1 算法中的主要参数列表

<table><tr><td>参数名称</td><td>参数含义</td></tr><tr><td>limit_of_time</td><td>算法限制时间</td></tr><tr><td>i</td><td>当前迭代次数</td></tr><tr><td>H</td><td>一个种群中个体总数</td></tr><tr><td>num_of_array</td><td>天线阵子个数</td></tr><tr><td>theta_0</td><td>目标波束赋形方向</td></tr><tr><td>phase_bits</td><td>每个天线阵子的相位基因段比特数</td></tr><tr><td>amplitude_bits</td><td>每个天线阵子的幅度基因段比特数</td></tr><tr><td>array_bits</td><td>每个天线阵子的基因段总比特数</td></tr><tr><td>num_of_Qbit</td><td>每个个体基因段总比特数</td></tr><tr><td>Q</td><td>量子比特种群</td></tr><tr><td>B</td><td>精英种群</td></tr><tr><td>B_f</td><td>精英种群的适应度向量</td></tr><tr><td>P</td><td>新生种群</td></tr><tr><td>P_f</td><td>新生种群的适应度向量</td></tr></table>

其中， $i$  是大于等于1的整数； $H$  在此问题中设为80，num_of_array 设为32；Q 是一个大小为  $H \times \text{num\_of\_Qbit}$  的二维矩阵，Q 的每一个元素分别是对应量子比特的  $\beta$  。一些参数之间具有如下关系：

$$
array\_ bits = phase\_ bits + amplitude\_ bits \tag{3.9}
$$

$$
num\_ of\_ Qbit = num\_ of\_ array\times array\_ bits \tag{3.10}
$$

# 3.2.2 QEA基本流程

QEA算法的流程图如图3.3所示。本文使用的QEA算法是基于文献[5]的算法改进而来的，主要有以下不同：

a. 不再使用局部迁移和全局迁移等迁移策略。

b. 采用精英选择方式，上一代精英种群和本代新生种群同时参与自然选择，保留精英个体得到本代精英种群。

c. 本文设定  $\alpha$  和  $\beta$  的取值均不得超过  $\sin (0.44\pi)$ ，也不得低于  $\cos (0.44\pi)$ 。

具体原因如下：

a. 迁移策略会导致所有个体向着同一方向进化，削弱了算法的全局搜索能力，算法容易陷入局部最优解。

b. 不使用迁移策略但还需选出优秀个体进行量子比特更新的操作，故采用精英选择的策略。本文没有采用轮盘赌或者锦标选择的方法，而是对个体适应度值进行排序，选择前  $H$  个个体作为精英个体构成精英种群。这是因为轮盘赌或者锦标选择方法会让优秀个体有一定概率被淘汰而不能稳定存在，不能稳定存在就不能得到充分进化。

c. 如果不设置阈值，则量子比特的状态在迭代的过程中会逐渐逼近于“0”状态或“1”状态，叠加态的特性将会消失，导致算法过早收敛。设置一个阈值会增强算法的全局搜索能力，即使迭代一段时间，量子比特虽大概率会坍缩为某一状态，但仍有一定概率坍缩为另一状态。

![](https://i.ibb.co/C5Rt86hr/3s3.jpg)
图3.3 QEA算法流程

算法整体流程的伪代码如算法1所示，算法向适应度值下降的方向优化。

# 算法1：QEA算法流程

Input: limit_of_time,  $H$  ，num_of_array，phase_bits，amplitude_bits，array_bits， num_of_Obit,theta_0

Output:B_alpha,B_beta

1：初始化Q-bit种群：创建元素全为$1 / \sqrt{2}$，大小为$H\times$num_of_Obit的矩阵Q

2： $i\gets 0$

3： 观察Q- bit种群：B，B_alpha，B_beta  $=$  make(Q，num_of_Obit，H)

4： 计算适应度值：  $\mathbf{B}_{- }\mathbf{f} =$  fitness(B，B_alpha，B_beta，theta_0)

5： while True:

6：     $i\gets i + 1$

7：     观察Q- bit种群：P，P_alpha，P_beta  $=$  make(Q，num_of_Obit，H)

8：     计算适应度值：  $\mathbf{P}_{- }\mathbf{f} =$  fitness(P，P_alpha，P_beta，theta_0)

9：     更新Q- bit种群：  $\mathbf{Q} =$  update(Q，B_f，P_f，B，P)

10：     精英选择：根据B_f和P_f选出精英种群B，根据对应关系得到Q，B_f，B_alpha,B_beta

11：     if当前时间  $> =$  limit_of_time:

12：         break

13：     endif

14： endwhile

算法1步骤  $1\sim 5$  完成了算法的初始化。首先设置算法的基本参数，然后对Q-bit种群进行初始化操作，即将所有量子比特的  $\beta$  设置为  $1 / \sqrt{2}$  ，量子比特坍缩为“0”状态或“1”状态的概率相同；步骤5通过fitness函数计算初始种群每个个体的适应度值，因为评分函数最终得到的是一个加权平均分，是单目标优化，所以得到的B_f是长度为  $H$  的一维数组。

算法1步骤6~14是迭代流程。在每次迭代开始时，步骤7先通过make函数观察Q-bit种群Q，使量子比特种群坍缩生成新一代种群B，并得到相位B_alpha和振幅B_beta。make函数的伪代码如算法2所示。观察量子比特的方法是：生成一个[0,1)之间的随机数，若该随机数小于  $\beta^2$  则量子比特坍缩为“1”状态，否则坍缩为“0”状态。观察量子比特种群后，量子比特由叠加态坍缩为确定态，变成了经典比特，这样就可以通过二进制译码的方式得到相位和振幅。二进制译码映射到相位的方法是：首先将相位基因段的二进制数转为十进制数，因为相位的取值范围为  $[0,2\pi)$  ，所以再将这个十进制数乘以 $2\pi /2^{phase\_ bits}$  。二进制译码映射到振幅的方法是：首先将振幅基因段的二进制数用bit2int函数转为十进制数，因为振幅的取值范围为[0,1]，所以再将这个十进制数乘以2再加1最后除以  $2^{phase\_ bits + 1}$  。因为赛题要求振幅可以做连续优化，但算法由于量子比特的离散机制不能做到真正意义上的连续优化，故优化振幅时设phase_bits为6，以满足精度要求。

# 算法2：make函数算法流程

Input: Q，num_of_Qbits，H

Output:P,P_beta,P_alpha

1: $\mathbf{P} = \mathrm{random}(H,\mathrm{num\_of\_Qbit})$

2: for每个元素inP:

3:     if元素值  $< Q$  对应位置元素值：

4:         元素值  $\leftarrow 1$

5:     else:

6:         元素值  $\leftarrow 0$

7:     endif

8: end for

9: if优化振幅：

10:     P_beta  $=$  bit2int(P)

11:     P_alpha  $=$  bit2int(P)

12: else:

13:     P_beta  $=$  ones(P)

14:     P_alpha  $=$  bit2int(P)

15: endif

算法1步骤8中，得到相位和振幅后就可以通过fitness函数计算每个个体的适应度值，具体的方法可以参考赛题的评分函数。但与赛题评分函数有一点不同的是，得到的分数即使为负数也不置0，这是为了确保算法能够有进化方向。因为算法在初始化时随机生成的种群大概率是不满足赛题要求的，如果将分数置0那么种群中所有个体的适应值大概率都为0，每个个体的适应度值之间就没有区别，分不清优劣，就没有进化的方向。

算法1步骤9中使用update函数对Q-bit种群进行更新操作，update函数的伪代码如算法3所示。对Q-bit种群进行更新操作的目的是调整量子比特坍缩的概率，使量子比特有更大的概率坍缩为当前的优秀个体，实现种群的进化。Q-bit更新操作可以参考3.1.2章节，其中  $\Delta \theta$  的设计准则如表3.2所示。其中  $p_{ij}$  表示新一代种群  $\mathbf{P}$  中的第  $(i,j)$  个数据，即第  $i$  个个体的第  $j$  个比特，  $b_{ij}$  表示精英种群  $\mathbf{B}$  中的第  $(i,j)$  个数据，用  $\mathbf{P\_ f}_i / \mathbf{B\_ f}_i$  分别表示新生种群  $\mathbf{P}$  和精英种群  $\mathbf{B}$  第  $i$  个个体的适应度值。

在传统的量子启发算法[5]中，随着不断迭代，可能会有某个个体长期处于优势地位，从而导致量子比特在旋转门的作用下无限向同一个方向旋转，导致概率振幅  $\alpha$  或  $\beta$  无限趋近于1，从而丧失了量子比特的叠加特性，量子比特在每次被观察时，都确定地坍缩至某一确定态，这种情况会导致种群早熟和收敛。因此，为了保证某些个体占据优势地位时，种群中的基因仍然存在“变异”的可能，应该设定  $\alpha$  和  $\beta$  值的上限小于1，下限大于0，本文中设定二者最大不得超过  $\sin (0.44\pi)$ ，最小不得低于  $\cos (0.44\pi)$ 。

# 算法3：update函数算法流程

Input: P_f, B_f, P, B, Q

Output:Q

1: $\mathbf{S} = \mathbf{P\_f}-\mathbf{B\_f}$$

2: for  $i$  ，  $j$  in  $\mathbf{Q:}$

3:     if  $(\mathbf{P}[i,j] = 0)$  &  $(\mathbf{B}[i,j] = 1)$  &  $(\mathbf{S}[i] > 0):

4:         $\Delta \theta = 0.01\pi$$

5:     elseif  $(\mathbf{P}[i,j] = 1)$  &  $(\mathbf{B}[i,j] = 0)$  &  $(\mathbf{S}[i] > 0):

6:         $\Delta \theta = -0.01\pi$

7:     else:

8:         $\Delta \theta = 0$

9:     endif

10:    使用参数为  $\Delta \theta$  的量子旋转门更新  $\mathbf{Q}$

11:    if  $\mathbf{Q}[i,j] > \sin (0.44\pi)$

12:        $\mathbf{Q}[i,j] = \sin (0.44\pi)$

13:    elseif  $\mathbf{Q}[i,j]< \cos (0.44\pi)$

14:        $\mathbf{Q}[i,j] = \cos (0.44\pi)$

15:    endif

16：endfor

表3.2  $\Delta \theta$  的确定准则

![](https://i.ibb.co/fdBdf3Mp/b3s2.jpg)

算法1步骤10中，精英选择是在新生种群  $\mathbf{P}$  和上一代精英种群  $\mathbf{B}$  两个种群中进行选择，根据适应度值的大小对个体进行排序，选择出前  $H$  个个体作为精英个体组成新的精英种群，余下个体被淘汰。相应地，如相位、幅度等与精英个体相关的变量，也需要随之迁移。

# 4 结果与分析

# 4.1 数据测试方法

为了探究不同角度下赋形结果的变化趋势，本文在  $45^{\circ}\sim 135^{\circ}$  范围之间每隔  $5^{\circ}$  选取一个测试角度进行测试。为了削弱算法随机性的影响，本文对每一个测试角度进行10次测试，并取10次测试的平均分作为该测试角度的结果分数。

测试所有数据需要花费的总时间大约是40小时左右，时间占用较长，因此不宜在官方提供的JupyterLab环境中测试数据，因此对于每一次测试，为了与官方提供的测试环境保持一致，首先统计了在官方环境下运行QEA算法90秒时的迭代次数，然后再转入本地Pycharm环境下，运行同样的迭代次数，以保证分析测试环境与官方环境一致。经试验，在官方JupyterLab环境下，不同测试条件对应的所需迭代次数如表4.1所示，作为以后测试的参照。

表4.1 测试条件与选代次数参照表

<table><tr><td>相位量化比特数</td><td>是否优化振幅</td><td>所需迭代次数</td></tr><tr><td>1</td><td>是</td><td>2650</td></tr><tr><td>2</td><td>是</td><td>2610</td></tr><tr><td>3</td><td>是</td><td>2550</td></tr><tr><td>4</td><td>是</td><td>2550</td></tr><tr><td>1</td><td>否</td><td>2790</td></tr><tr><td>2</td><td>否</td><td>2750</td></tr><tr><td>3</td><td>否</td><td>2720</td></tr><tr><td>4</td><td>否</td><td>2700</td></tr></table>

# 4.2 数据测试结果

根据上文所述的测试方法，分别对“优化振幅”和“不优化振幅”两种情况进行测量，并将得到的数据做出折线图，分别如图4.1和图4.2所示。

分别观察优化振幅和不优化振幅条件下相位量化2~4比特时的数据折线图，可以归纳出以下规律：

a. 折线均出现两边低中间高的趋势；

b. 除1比特数据折线外，其他比特数目的数据折现均出现明显的对称性；

c. 量化比特数目增加，曲线开口变宽；量化比特数目减小，曲线开口变窄；

![](https://i.ibb.co/4n48mVMs/4s1.jpg)
图4.1 优化振幅时得分均值随目标优化角度的变化情况

![](https://i.ibb.co/7NvzRn5m/4s2.jpg)
图4.2 不优化振幅时得分均值随目标优化角度的变化情况

1比特数据折线图比较特殊，它具有以下特点：

a. 不同角度之间分数差异极大，最高值与2~4比特时的数据相近甚至更好；

b. 数据存在较多的零分。

# 4.3 测试结果分析

“两边低中间高”是折线图最主要的趋势，反映了不同目标指向角度的优化难度不同，目标指向角度在中心角度  $90^{\circ}$  附近时，容易优化得到较好的优化结果，而目标指向角度越靠近边缘角度  $45^{\circ}$  或  $135^{\circ}$  越难优化。从方向图对称性的角度分析，指向角靠近  $45^{\circ}$  或  $135^{\circ}$  相当于端射方向（end-fire），而靠近  $90^{\circ}$  相当于侧射方向（broadside）。在端射方向，阵元间的波程差更大，最大可达  $d$  （阵元间距，本赛题取  $d = \lambda /2$  ），而侧射方向波程差为0，因此更容易形成较高的旁瓣。在  $45^{\circ}$  或  $135^{\circ}$  方向，主瓣左侧更靠近端射方向，所以旁瓣更高。因此目标指向角度越靠近边缘角度  $45^{\circ}$  或  $135^{\circ}$  时，旁瓣越难压制，波束越难优化。

观察发现，增加量化比特数，适应度值在  $45^{\circ}$  或  $135^{\circ}$  的区间会有明显的提升，而在  $90^{\circ}$  提升不明显，甚至1比特的情况会好于多比特的情况。从阵因子的角度分析，根据式（1.1），若希望在目标指向角度  $\theta_0$  处信号最强，即要求所有阵元的相位在  $\theta_0$  处相同（相干叠加）。根据阵因子的计算公式（1.2）可知，阵元的相位为  $\alpha_{n} + \pi n \cos \theta$ ，当  $\theta_0$  为  $90^{\circ}$  时，  $\cos 90^{\circ} = 0$ ，则相位完全由  $\alpha_{n}$  控制，且与  $n$  无关，此时只需设置所有  $\alpha_{n}$  相同即可实现相干叠加，优化难度低；当  $\theta_0$  为  $45^{\circ}$  时，  $\cos 45^{\circ} \approx 0.707$ ，则相位为  $\alpha_{n} + \pi n \times 0.707$ ，由于  $n$  的变化，需要为每个阵元设置不同的  $\alpha_{n}$  来补偿线性增长的相位差（即  $\alpha_{n}$  需要随  $n$  线性变化），且  $\theta_0$  越靠近  $45^{\circ}$ ，  $\cos \theta_0$  越大，相位差越难补偿。同时，由于相位离散化（如2比特只有4个取值），这种补偿可能不精确，导致主瓣偏移或旁瓣升高。这很好地解释了为什么在  $45^{\circ} \sim 85^{\circ}$  和  $95^{\circ} \sim 135^{\circ}$  的区间内增加量化比特数会导致适应度值明显提升，因为更多的量化比特精度更高，补偿更精确。而主瓣指向  $90^{\circ}$  时，不需要相位补偿，因此增加量化比特数效果提升不明显。从算法自由度和搜索空间的角度分析，但增加量化比特数是具有两面性的，一方面增加量化比特数会增加自由度，提供更多的选择，更高的精度会带来效果上的提升。另一方面增加量化比特数会增加搜索空间，当搜索空间过大，反而找不到较好的结果。所以增加量化比特数不一定是好的，需要结合具体问题的情况。指向角为  $90^{\circ}$时比较容易优化，因此不需要太高的自由度，若一味地增加量化比特数，增加自由度带来的效益小于增大搜索空间带来的损失，优化结果反而变差。指向角为  $45^{\circ} \sim 85^{\circ}$和$95^{\circ} \sim 135^{\circ}$  时比较难以优化，因此需要增加自由度来提升精度，此时增加量化比特数，增加自由度带来的效益大于增大搜索空间带来的损失，优化结果会更好。

# 4.4 算法稳定性测试

为了探究同等测试条件下算法的稳定性，我们对同一个测试角度进行十次测量（目标指向角度、相位量化比特数、是否优化振幅等条件保持不变），并对这十次的测量结果取方差，如图4.3和图4.4所示。因为1比特时很多测试角度下测得的适应度值都是0，分析方差没有意义，因此只测量了相位量化比特为2~4比特时的情况。

观察测试结果，可以得到以下几个特点：

a. 2~4比特数据测试结果均存在两边方差大，中间方差小的趋势；

b. 总体趋势上，比特数目越多，方差越小。

![](https://i.ibb.co/hJfZPGCL/4s3.jpg)
图4.3 优化振幅时的方差测试结果

![](https://i.ibb.co/XrwWrx6k/4s4.jpg)
图4.4 不优化振幅时的方差测试结果

由于QEA算法利用量子叠加态的特性，算法是存在随机性的，方差在一定程度上反映了这种随机性对优化结果的影响。方差越大，说明算法的运行越不稳定，反之算法的优化结果越稳定。初始种群是随机生成的，不确定性大，初始种群的好坏对最终的优化结果影响很大。且进化的方向也是随机的，算法每次运行都可能陷入不同的局部最优解。特别是在优化较难问题上，这种随机性带来的影响更大，这在观测结果中已经有所体现：边缘角度（ $45^{\circ} \sim 60^{\circ}$  和  $115^{\circ} \sim 135^{\circ}$ ）优化难度大方差随之也大，中心角度（ $60^{\circ} \sim 115^{\circ}$ ）优化难度小方差随之也小。而且对比图4.3和图4.4可以发现，优化振幅时的方差比不优化振幅时的方差普遍要大一些，这是因为优化振幅时解空间更大，算法的搜寻空间变大，算法的随机性被放大。

算法的不确定性影响可以克服，本文在下一章介绍的“归零”和“多核处理”方法可以有效克服算法的不确定性影响并有效跳出局部最优，不过由于赛题时间要求的限制，并没有使用这两种方法。

# 5 量子启发算法的扩展——非支配排序量子启发算法

# 5.1 非支配排序量子启发算法的优势及流程

![](https://i.ibb.co/JwFZ5h6q/5s1.jpg)
图5.1 NSQEA算法流程

严格意义上，本赛题是一个多目标优化问题，因为涉及到多个设计目标，赛题的评分函数通过线性加权和的方法求解多目标优化问题，本质上将多目标优化变成了单目标优化。本团队在比赛之初尝试采用一种使用非支配排序方法求解多目标问题的量子启发算法——非支配排序量子启发算法（Non-dominated Sorting Quantum Evolutionary Algorithm，NSQEA）进行阵列天线的波束赋形，但由于云资源算力和赛题要求的限制，最终放弃了非支配排序方法。但非支配排序方法相对于线性加权和方法是有很多优势的：

a. 线性加权和方法无法求出多目标规划像集的某些非凸部分的有效解或弱有效解，但是非支配排序方法不受Pareto最优前沿形状限制，不仅可以有效求解非凸问题，还可以求解离散问题。

b. 线性加权和法需要指定权重且只能得到一个决策方案，但是工程应用上很多情况是不能确定权重的且不同场景下对目标的侧重也是不同的，而非支配排序方法不需要指定权重，此方法致力于寻找整个Pareto最优前沿，提供了多个决策方案，方便决策者去寻找最适合当前环境下的方案。

c. 线性加权和法无法探明各个优化目标之间的权衡关系，而非支配排序方法通过搜寻Pareto最优前沿可以清晰明了地展示各个优化目标之间的关系。

考虑到其工程实用价值，本文有必要介绍一下NSQEA算法。NSQEA算法是一种受量子力学启发的新型多目标优化算法。NSQEA算法的流程如图5.1所示，与QEA算法的流程不同之处在于采用了非支配排序、“归零”、“多核处理”三种方法，分别为了解决多目标优化面临的非支配解数量爆炸、跳出局部最优效果有限、优化结果受初始种群不确定性影响大的三个问题。

# 5.2 新型快速非支配排序方法

算法4：新型快速非支配排序方法

1: 创建一个长为  $H$  的一维数组，其元素都为1， 名为Front;

2: 设置Maxfront  $= 1$

3: while true

4:     for  $i$  from1to  $H - 1$

5:         if Front(i)  $= \text{Maxfront}$

6:             for  $j$  from  $i + 1$  to  $H$

7:                 if Front(j)  $= =$  Maxfront

8:                     比较  $S(i)$  with  $S(j)$

9:                     if  $S(i)\succ S(j)$

10:                        $F r o n t(j) = M a x f r o n t + 1;$

11:                    else if  $S(i) = _{s}S(j)$  或  $S(i) = _{n}S(j)$

12:                        $F r o n t(j) = \mathrm{I n f i n i t y};$

13:                    else if  $S(i)\prec S(j)$

14:                        $F r o n t(i) = M a x f r o n t + 1;$

15:                        break

16:                    end if

17:                 end if

18:             end for

19:         endif

20:     end for

21:     if max(Front (Front  $\neq$  Infinity))  $= =$  Maxfront

22:         break

23:     else

24:         Maxfront  $= M a x f r o n t + 1;$

25:     endif

26: endwhile

本文采用的非支配排序方法是作者团队新提出的，与NSGA- II算法所用的方法不同。首先提出了新型支配关系的确定准则，该准则定义了多目标优化问题中适应度值之间的七种大小关系：严格大于、非严格大于、严格小于、非严格小于、严格等于、非严格等于以及相当关系，并对应到三种支配关系：支配、被支配、互不支配。表5.1直观展示了多目标优化问题中适应度值的大小关系与支配关系的对应情况，其中  $f, g \in \mathbb{R}^{+m}$ , $\epsilon \in \mathbb{R}^{+m}$ ，向适应度值降低的方向优化。然后根据新型支配关系的确定准则提出了新型快速非支配排序方法，与NSGA-II提出的快速非支配排序方法相比，空间复杂度从  $O(MH^2)$  下降到  $O(MH)$ ，尽管时间复杂度相同且都为  $O(MH^2)$ ，但是新方法不需要集合运算且实际上所需的循环数更少。新型快速非支配排序方法的伪代码如算法4所示，假设解集  $\mathbf{S}$  包含  $H$  个解，首先创建一个长为  $H$  且元素都为1的一维数组Front用来表征每个解处于的非支配层等级，即刚开始认为所有解都处于第一非支配层，支配层的最高等级为1。然后将处于最高等级非支配层的解之间互相比较以进一步分层，Maxfront表征正在分层的非支配层等级，重复这个过程直到处于最高等级非支配层的解之间都互不支配。

在NSQEA中使用的非支配排序算法，因为只建立了一个创建一个长为  $H$  的一维数组Front，申请的空间为  $H$ ，所以算法的空间复杂度为  $O(H)$ 。排序过程类似于冒泡排序法，从第一个个体开始逐一与后面的个体比较支配关系，若后面的个体被当前个体支配，则后面的个体相应的非支配层等级就要加1；若后面的个体与当前个体有着严格等于或非严格等于关系，则后面的个体非支配层的等级会被设置为Infinity，这代表着这个体将会移除，这个操作可以有效减少非支配解的数量以提升种群丰富度，而具有相当关系的个体则无需进行任何操作；若后面的个体支配当前个体，则与当前个体处于同一支配层的个体非支配层等级不变，而当前个体的非支配层等级要加1，这是因为互不支配关系不具有传递性，即若A与B互不支配，C是支配A的，但是不能认为C是支配B的，这是与单目标冒泡排序法区别最大的一点，然后从下一个非支配层等级为Maxfront的个体开始重复上述步骤，直到等级为Maxfront非支配层中的个体全部确定，然后Maxfront加1，开始对下一个非支配层进行处理，重复上面的操作直至所有个体都被分层。考虑最坏的情况，即在种群中  $H$  个个体被分为了  $H$  层的情况下，for循环需要执行  $(H - 1)? = \frac{H\cdot(H - 1)}{2} = \frac{1}{2} H^2 - \frac{1}{2} H$  次，因为有  $M$  个目标函数，在判断支配关系时还需要比较  $M$  次，故总的循环次数为  $\frac{1}{2} MH^2 - \frac{1}{2} MH$ ，忽略掉常数系数和低次项，算法的时间复杂度为  $O(MH^2)。$

表5.1 多目标问题支配关系的确定准则

![](https://i.ibb.co/Dgjxr7H3/b5s1.jpg)

</sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg></sg>

# 5.3 “归零”方法

“归零”方法是为了跳出局部最优解而提出的。如何有效地跳出局部最优解是智能优化算法领域一直面临的一个难题。传统的进化算法，如NSGA-III[9]，主要依赖染色体的交叉与变异操作来跳出局部最优。然而，这种方法的效果受限，其根本原因在于“顶端优势”的存在。“顶端优势”是一个生物学概念，指顶芽会抑制侧芽的生长。本文发现在多目标进化算法中也会出现类似现象：由于精英选择策略的作用，处于第一非支配层中的解会抑制处于其他非支配层的解的发展。精英策略只保留当前表现优秀的个体，而其他暂时不优秀但具有潜力进化为优秀解的个体不一定在每次筛选中得到保留，即难以稳定存在。若无法稳定存在，也就无法持续进化，从而限制了算法跳出局部最优解。

实践应用也表明，即使采用交叉与变异操作，算法在迭代过程中仍容易陷入局部最优，长时间内难以跳出。摆脱局部最优的关键在于消除“顶端优势”。“归零”方法的策略是设置一个初始化条件，当迭代次数达到该条件时，说明算法陷入局部最优，便对种群进行重新初始化，从而清除当前的局部最优。由于初始化的随机性，初始化后生成的解的进化方向会大概率不同于之前的进化方向，所以在此之后继续迭代，会有较高的概率跳出原先的局部最优。但是“归零”方法并不能保证算法一定会找到全局最优解，“归零”方法的目的是跳出之前的局部最优然后寻找别的局部最优，尽可能多地找到不同的局部最优。本质上全局最优解也是局部最优解，所以“归零”方法可以大幅提高找到全局最优解的概率。需要注意的是，初始化条件并非固定值，而是可根据迭代过程中种群表现灵活调整。

# 5.4 “多核处理”方法

“多核处理”方法是为了提升种群多样性而提出的。传统的进化算法通常采用轮盘赌或锦标赛选择等方法来增加种群多样性，但这些方式存在一个问题：非支配解也可能被淘汰。此外，若一个解希望继续得到进化，其前提是能够在种群中稳定存在较长时间。尽管轮盘赌与锦标赛方法在每一代中保留了部分被支配解以提升多样性，但每轮迭代所保留的被支配解可能都不同，导致这些解无法稳定存在，也就无法充分进化为非支配解。

而且，在传统进化算法中，许多个体容易陷入相同的局部最优，表现为目标函数值接近、结构相似，导致个体资源被浪费。当然，让所有解的结构完全不同也并非理想情况，这种极端情况会导致结构优化不够充分。因此，较优的策略是针对每一类结构配置适当数量的个体。

为解决上述问题，本文受多核处理器的启发，提出一种“多核处理”方法。该方法将整个种群划分为多个子种群，每个子种群被称为一个“核心（core）”，每个核心独立优化。由于算法具有随机性，各核心演化方向各不相同，从而确保整体种群的多样性。此外，单个核心规模较小，因此落入同一类局部最优的个体数量也较少。

假设每个核心包含k个个体，在对一个核心进行非支配排序时，只保留前k个个体，以保证解能稳定存在并持续进化。核心数量可根据问题具体情况进行调整。目标函数数量较少、局部最优较少的问题可使用较少核心以加快迭代速度；而对于目标函数数量多、局部最优较多的问题，则可增加核心数量以增强全局搜索能力。但核心数量不宜过多，否则会导致每个核心中的量子比特个体数量过少，影响优化效果。

此外，“多核处理”方法还可有效降低非支配排序的时间复杂度。假设量子比特种群中的量子比特个体数为H，目标函数数量为M，核心数量为k，则每个核心包含  $H / k$  个体，单核心非支配排序的时间复杂度为  $O(MH^2 /k^2)$ ，总共k个核心，因此总时间复杂度为  $O(MH^2 /k)$ 。相比之下，未采用“多核处理”方法的非支配排序时间复杂度为  $O(MH^2)$ 。可见，“多核处理”方法不仅提升了种群多样性和全局搜索能力，同时在大规模优化中也具有更高的效率。

# 5.5 非支配排序量子启发算法应用

非支配排序量子启发算法已经应用到了基于多端口网络的像素天线的设计当中，面对更多目标优化（4个目标及以上）体现了比NSGA- III更卓越的性能，由于篇幅限制，在此不详细举出实例。设计实例证明了NSQEA算法在迭代速度、迭代效果、克服初始种群不确定影响、全局搜索、跳出局部最优等诸多方面均优于当前流行的NSGA- III算法，展示了其在天线电磁多目标优化问题领域具有显著的性能优势。NSQEA算法本身是一种多目标优化算法，具有通用性和可移植性，可以应用到各种组合优化问题，包括但不限于路径规划、频谱分配、投资组合等。

# 6 参考文献

[1] JIANG J., XIAO P., CHEN P., et al. Utilizing Photonic Crystal Structure to Design Microstrip Antenna with Controllable Dielectric Constant Substrate[J]. Waves Random Complex Media, 2022, 32(4): 1713- 1724.

[2] RAO S. K., OSTROOT C. Design Principles and Guidelines for Phased Array and Reflector Antennas [Antenna Applications Corner] [J]. IEEE Antennas Propag. Mag., 2020, 62(2): 74- 81.

[3] KORMILAINEN R., HANNULA J.- M., SAARINEN T. O., et al. Realizing Optimal Current Distributions for Radiation Efficiency in Practical Antennas[J]. IEEE Antennas Wireless Propag. Lett., 2020, 19(5): 731- 735.

[4] SARMAH K., GOSWAMI S., BARUAH S. Surrogate Model Assisted Design of CSRR Structure Using Genetic Algorithm for Microstrip Antenna Application[J]. Radioengineering, 2020, 29(1): 117- 124.

[5] HAN K., KIM J. Quantum- Inspired Evolutionary Algorithm for a Class of Combinatorial Optimization[J]. IEEE Trans. Evol. Comput, 2002, 6(6): 580- 593.

[6] LEE S., LIM Q., ROSS C. et al. Quantum Annealing for Electromagnetic Engineers - - Part I: A Computational Method to Solve Various Types of Optimization Problems[J]. IEEE Antennas and Propagation Magazine, 2024, 3- 11.

[7] PENG F., CHEN X. Quantum- Inspired Algorithm Enhances Efficiency in Antenna Optimization[J]. IEEE Transactions on Antennas and Propagation, 2024, 72(9): 6980- 6991.

[8] DEB K., PRATAP A., AGARWAL S., et al. A Fast and Elitist Multiobjective Genetic Algorithm: NSGA- II[J]. IEEE Transactions on Evolutionary Computation, 2002, 6(2): 182- 197.

[9] DEB K., JAIN H. An Evolutionary Many- Objective Optimization Algorithm Using Reference- Point- Based Non- dominated Sorting Approach, Part I: Solving Problems with Box Constraints[J]. IEEE Transactions on Evolutionary Computation, 2014, 18(4): 577- 601.
