\documentclass[pra,twocolumn,superscriptaddress,floatfix,nofootinbib,amsmath,amssymb]{revtex4-1}

\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage{xeCJK}
\usepackage{float}
\usepackage{graphicx}
\usepackage{bm}
\usepackage{braket}
\usepackage{xcolor}
\usepackage{amsfonts}
\usepackage{comment}
\usepackage{dirtytalk}
\usepackage{url}
\usepackage{bbold}
\usepackage{realboxes}
\usepackage{my_macro}
\usepackage{enumitem}
\usepackage{booktabs}
\usepackage{algpseudocode}
\usepackage{subcaption}
\usepackage{caption}
\usepackage{hyperref}
\usepackage{cleveref}
\usepackage{tikz}
\usetikzlibrary{positioning}
\usepackage{xcolor}
\hypersetup{
    bookmarksopen=true,
    colorlinks=true,
    linkcolor=blue,
    citecolor=green,
    urlcolor=blue
}
\newcommand{\fancylink}[2]{\[\footnotesize\Colorbox{bkgd}{\color{orange-red}\href{#1}{\linkcode{#2}}}\]}

\newcommand{\spliteq}[1]{\begin{equation}
\begin{split}
#1
\end{split}
\end{equation}
}

\newcommand{\tr}{\text{tr}}

\usepackage{listings}
\lstset{stepnumber=0}

\UseRawInputEncoding
\usepackage{titlesec} %自定义多级标题格式的宏包
\titleformat{\paragraph}[block]{\small\bfseries}{}{}{}[]
% \titleformat{\paragraph}[block]{\small\bfseries}{}{1em}{}[]

\numberwithin{equation}{section}
\numberwithin{figure}{section}
\numberwithin{table}{section}

\definecolor{bkgd}{RGB}{240,242,246}
\definecolor{ceruleanblue}{rgb}{0.16, 0.32, 0.75}
\definecolor{orange-red}{rgb}{1.0, 0.27, 0.0}
\definecolor{anotherblue}{RGB}{37,92,243}
\definecolor{blackblue}{RGB}{46,60,85}
\definecolor{goldyellow}{RGB}{199,146,12}


\lstdefinestyle{altstyle2}{
    backgroundcolor=\color{bkgd},
    basicstyle=\ttfamily\footnotesize\color{blackblue},
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    commentstyle=\color{goldyellow},
    keepspaces=true,
    keywordstyle=\color{orange-red},
    language=Python,
    numbersep=5pt,
    numberstyle=\tiny\color{ceruleanblue},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    stringstyle=\color{anotherblue},
    tabsize=2,
    numbers=left
}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    language=Python,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2
}
\lstset{style=altstyle2}

\bibliographystyle{apsrev4-1}

\begin{document}

\title{MindSpore Quantum: A User-Friendly, High-Performance, and AI-Compatible Quantum Computing Framework
}

\author{Xusheng Xu}
\email{thuxuxs@163.com}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Jiangyu Cui}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Zidong Cui}
\affiliation{Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu 610051, China}
\author{Runhong He}
\affiliation{State Key Laboratory of Computer Science, Institute of Software Chinese Academy of Sciences, Beijing 100190}
\author{Qingyu Li}
\affiliation{Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu 610051, China}
\author{Xiaowei Li}
\affiliation{Shenzhen Institute for Quantum Science and Engineering, Southern University of Science and Technology, Shenzhen 518055, China}
\author{Yanling Lin}
\affiliation{School of Computer Science and Technology,
    University of Science and Technology of China, Hefei 230027, China}
\author{Jiale Liu}
\affiliation{School of Computer Science and Technology,
    University of Science and Technology of China, Hefei 230027, China}
\author{Wuxin Liu}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Jiale Lu}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Maolin Luo}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Chufan Lyu}
\affiliation{Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu 610051, China}
\author{Shijie Pan}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Mosharev Pavel}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Runqiu Shu}
\affiliation{School of Automation Science and Engineering, South China University of Technology, Guangzhou 510641, China}
\author{Jialiang Tang}
\affiliation{Department of Physical Chemistry, University of the Basque Country UPV/EHU, Apartado 644, 48080 Bilbao, Spain}
\author{Ruoqian Xu}
\affiliation{Department of Physical Chemistry, University of the Basque Country UPV/EHU, Apartado 644, 48080 Bilbao, Spain}
\author{Shu Xu}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Kang Yang}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Fan Yu}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Qingguo Zeng}
\affiliation{Shenzhen Institute for Quantum Science and Engineering, Southern University of Science and Technology, Shenzhen 518055, China}
\author{Haiying Zhao}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Qiang Zheng}
\affiliation{School of Computer Science and Technology,
    University of Science and Technology of China, Hefei 230027, China}
\author{Junyuan Zhou}
\email{jedzhou99@163.com}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\author{Xu Zhou}
\affiliation{School of Physics and Astronomy, Sun Yat-sen University, Zhuhai 519082, China}
\author{Yikang Zhu}
\affiliation{School of Computer Science and Technology,
    University of Science and Technology of China, Hefei 230027, China}
\author{Zuoheng Zou}
\email{zouzuoheng@pku.edu.cn}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}


\author{Abolfazl Bayat}
\affiliation{Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu 610051, China}
\affiliation{Key Laboratory of Quantum Physics and Photonic Quantum Information, Ministry of Education,
    University of Electronic Science and Technology of China, Chengdu 611731, China}
\author{Xi Cao}
\affiliation{Department of Automation, Tsinghua University, Beijing 100084, China}
\affiliation{Key Laboratory of Quantum Physics and Photonic Quantum Information, Ministry of Education,
    University of Electronic Science and Technology of China, Chengdu 611731, China}
\author{Wei Cui}
\affiliation{School of Automation Science and Engineering, South China University of Technology, Guangzhou 510641, China}
\author{Zhendong Li}
\affiliation{Key Laboratory of Theoretical and Computational Photochemistry, Ministry of Education,
    College of Chemistry, Beijing Normal University, Beijing 100875, China}
\author{Guilu Long}
\affiliation{Beijing Academy of Quantum Information Sciences, Beijing 100193, People’s Republic of China}
\affiliation{State Key Laboratory of Low-Dimensional Quantum Physics and Department of Physics, Tsinghua University, Beijing 100084, People’s Republic of China}
\author{Zhaofeng Su}
\affiliation{School of Computer Science and Technology,
    University of Science and Technology of China, Hefei 230027, China}
\author{Xiaoting Wang}
\affiliation{Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu 610051, China}
\affiliation{Key Laboratory of Quantum Physics and Photonic Quantum Information, Ministry of Education,
    University of Electronic Science and Technology of China, Chengdu 611731, China}
\author{Zizhu Wang}
\affiliation{Institute of Fundamental and Frontier Sciences, University of Electronic Science and Technology of China, Chengdu 610051, China}
\affiliation{Key Laboratory of Quantum Physics and Photonic Quantum Information, Ministry of Education,
    University of Electronic Science and Technology of China, Chengdu 611731, China}
\author{Shijie Wei}
\affiliation{Beijing Academy of Quantum Information Sciences, Beijing 100193, People’s Republic of China}
\author{Re-Bing Wu}
\affiliation{Department of Automation, Tsinghua University, Beijing 100084, China}
\author{Pan Zhang}
\affiliation{CAS Key Laboratory for Theoretical Physics, Institute of Theoretical Physics,
    Chinese Academy of Sciences, Beijing 100190, China}

\author{Man-Hong Yung}
\email{yung@sustech.edu.cn}
\affiliation{Quantum Science Center of Guangdong-Hong Kong-Macao Greater Bay Area (Guangdong), Shenzhen, China}
\affiliation{Shenzhen Institute for Quantum Science and Engineering, Southern University of Science and Technology, Shenzhen 518055, China}
\affiliation{International Quantum Academy, Shenzhen 518048, China}
\affiliation{Guangdong Provincial Key Laboratory of Quantum Science and Engineering, Southern University of Science and Technology, Shenzhen 518055, China}
\affiliation{Shenzhen Key Laboratory of Quantum Science and Engineering, Southern University of Science and Technology, Shenzhen 518055, China}

\date{\today}

\keywords{quantum machine learning, neural networks, quantum neural networks, variational quantum algorithms, machine learning, quantum algorithms}


\begin{abstract}
    We introduce MindSpore Quantum, a pioneering hybrid quantum-classical framework with a primary focus on the design and implementation of noisy intermediate-scale quantum (NISQ) algorithms. Leveraging the robust support of MindSpore, an advanced open-source deep learning training/inference framework, MindSpore Quantum exhibits exceptional efficiency in the design and training of variational quantum algorithms on both CPU and GPU platforms, delivering remarkable performance. Furthermore, this framework places a strong emphasis on enhancing the operational efficiency of quantum algorithms when executed on real quantum hardware. This encompasses the development of algorithms for quantum circuit compilation and qubit mapping, crucial components for achieving optimal performance on quantum processors. In addition to the core framework, we introduce QuPack—a meticulously crafted quantum computing acceleration engine. QuPack significantly accelerates the simulation speed of MindSpore Quantum, particularly in variational quantum eigensolver (VQE), quantum approximate optimization algorithm (QAOA), and tensor network simulations, providing astonishing speed. This combination of cutting-edge technologies empowers researchers and practitioners to explore the frontiers of quantum computing with unprecedented efficiency and performance.
\end{abstract}
\maketitle
\tableofcontents
\section{Introduction}

\input{1_Introduction}

\section{Elements of MindSpore Quantum}
\label{sec:elements}

View demo code of this chapter: \demonotebook{02}{chapt02}

\subsection{Data Type}
\input{2.1_Data_Type}

\subsection{Parameter Resolver}
\input{2.2_Parameter_Resolver}

\subsection{Quantum Gate}
\input{2.3_Quantum_Gate}

\subsection{Quantum Circuit}
\input{2.4_Quantum_Circuit}

\subsection{Observable and Hamiltonian}
\input{2.5_Quantum_Operator}

\subsection{Basic Usage of Simulator}
\label{sec:sim_basic_usage}
\input{2.6_Basic_Usage_of_Simulator}


\section{Circuit Simulation Backend}
\label{sec:backend}

\input{3.1_State_Vector_and_Density_Matrix_Simulator}

\subsection{Channel Based Noise Simulator}
\input{3.3_Channel_Based_Noise_Simulator}

\section{ToolBox of MindSpore Quantum}
\label{sec:toolbox}

View demo code of this chapter: \demonotebook{04}{chapt04}

\subsection{Gradient of Variational Quantum Algorithm}
\input{4.1_Gradient_of_Variational_Quantum_Algorithm}

\subsection{Circuit Ansatz Library}
\input{4.2_Circuit_Ansatz_Library}

\subsection{Quantum Algorithm Subroutine}
\input{4.3_Quantum_Algorithm_Subroutine}


\section{Applications}
\label{sec:applications}
\subsection{Quantum Neural Network}

% [1] School of Physics and Astronomy, Sun Yat-sen University, Zhuhai 519082, China\\

% [2] QUDOOR Co, Ltd., Beijing 100089, China\\

% Email: \url{zhouxu@qudoor.cn}



\input{5.1_Quantum_Neural_Network}

\subsection{Quantum Approximate Optimization Algorithm}
\input{5.2_Quantum_Approximate_Optimization_Algorithm}

\subsection{Variational Quantum Eigensolver}
\input{5.3_Variational_Quantum_Eigensolver}

\input{5.4_Advanced_Quantum_Aplications}


\section{QuPack: Acceleration Engine}
\label{sec:qupack}
\input{6_QuPack_Acceleration_Engine}

\subsection{Variational Quantum Eigensolver}
\input{6.1_Variational_Quantum_Eigensolver}

\subsection{Quantum Approximate Optimization Algorithm}
\input{6.2_Quantum_Approximate_Optimization_Algorithm}

\subsection{Tensor Network Simulator}
\input{6.3_Tensor_Network_Simulator}

\subsection{Pulse Engineering}
\input{6.4_Pulse_Engineering}


\section{Benchmarking}
\label{sec:benchmark}

View benchmarking code: \href{https://gitee.com/mindspore/mindquantum/blob/research/whitepaper/code/benchmark}{\color{ceruleanblue}{CPU}} \href{https://gitee.com/mindspore/mindquantum/blob/research/whitepaper/code/benchmark_gpu}{\color{ceruleanblue}{GPU}}

\input{7_Benchmarking}


\section{Execution on Quantum Chip}
\label{sec:chip}
\subsection{Circuit Compilation and Optimization}
\input{8.1_Circuit_Compilation_and_Optimization}

\subsection{Qubit Mapping}
\input{8.2_Qubit_Mapping}

% \subsection{Quantum Virtual Machine}
% \input{8.3_Quantum_Virtual_Machine}

% \subsection{Third-party Quantum Chip}
% \input{8.4_Third-party_Quantum_Chip}

\section{Summary}
\label{sec:summary}
We introduced \MindQuantum, a hybrid quantum-classical framework which focus on the design and implement of NISQ algorithm, especially Variational Quantum Algorithm. First, we showed the eDSL (embedded domain specific language) of how to manipulate quantum gate, quantum circuit and observable. \MindQuantum\ support arbitrary control qubits on any quantum gate, and based on JIT, high performance arbitrary costumed parameterized or non-parameterized gate is also supported. Then we showed how we implement state vector, density matrix and noisy quantum simulator and how we optimized the simulation with gate based optimization with SIMD, OpenMP, Kunpeng and GPU acceleration. Furthermore, we provide numerous application examples to help you quickly grasp the usage of \MindQuantum. These applications include VQE, QAOA and QNN. An acceleration engine call \QuPack\ was introduced, including how we speed up the simulation of VQE and QAOA algorithm. A benchmark on the performance compared with other quantum frameworks was demonstrated in Chapter ~\ref{sec:benchmark}, which showed advantages of \MindQuantum\ in several scenarios. Finally, we also showed the work that we have done about how to quickly compile and execute a quantum circuit on a real quantum chip.

\section{Acknowledgement}
\label{sec:acknowledgement}
We sincerely thank the authors of this paper and their respective contributions, as shown in table \ref{tab:contributions}.

\begin{table}[ht]
    \begin{tabular}{|p{3cm}|p{3cm}|}
        \toprule
        Author        & Section                                        \\
        \midrule
        Qingyu Li     & 2.1, 2.2, 5.3                                  \\
        Qiang Zheng   & 2.3                                            \\
        Jiale Liu     & 2.4                                            \\
        Yanling Lin   & 2.5, 5.9                                       \\
        Xusheng Xu    & 1, 2.6, 3.1, 3.2, 3.3, 4.1, 6.1, 7, 8.1, 9, 10 \\
        Zuoheng Zou   & 6.2, 6.3, 7                                    \\
        Junyuan Zhou  & 3.3, 4.2, 4.3, 7                               \\
        Xu Zhou       & 5.1                                            \\
        Jialiang Tang & 5.2                                            \\
        Ruoqian Xu    & 5.4                                            \\
        Chufan Lyu    & 5.5                                            \\
        Runhong He    & 5.6                                            \\
        Runqiu Shu    & 5.7                                            \\
        Zidong Cui    & 5.8, 6.4                                       \\
        Yikang Zhu    & 8.2                                            \\
        \bottomrule
    \end{tabular}
    \caption{Contributions of authors}
    \label{tab:contributions}
\end{table}

We are thankful to Shu Xu, Maolin Luo, Shijie Pan and Mosharev Pavel for their review of this paper. We also thank Damien Ngyuen, Kai Zhang, Qin Li, Jinlin Zeng, Qi Yan, FangFang Yi, Youkun Ren, Hui Yang, Jiwei Xie, Ting Wang, Haoran Yang, YiXing Feng, Ting Wang, Han Yu, Xiaoling Huan, Jianing Luo and many other people for the contribution of continuous integration and documentation and Shenyu Huang, Xiaopeng Cui, Bowen Liu, Yao Wang for the contribution in promoting. We would like to thank all the contributors and users of \MindQuantum. It is the collective effort and attention of you that keeps this project going.
This work is supported by the National Natural Science Foundation of China under the Grant No. 62273154, the China Postdoctoral Science Foundation under Grant No. 2023M740874, and the China Scholarship Council (CSC) under Grants No. 202206890003 and No. 202306890004.
\bibliography{lib.bib}

\end{document}
